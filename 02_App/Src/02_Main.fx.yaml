"'02_Main' As screen":
    OnHidden: =
    OnVisible: |-
        =// Reset mass approval
        UpdateContext({locMassiveApproval: false});
        Set(locMassiveApproval, false); 
        Reset(toggleMassiveApproval);
        
        Set(SelectedPerson_ID, Blank());
        Set(SelectedPerson_Name, Blank());
        ClearCollect(colMassiveApproval, Blank());
        
        // Default mode of details pane is view
        Set(DetailsFormMode, FormMode.View);
        
        // Set val for greyout app
        Set(locGreyOutVis, false);
        
        // User groups for approval
        ClearCollect(colUserGroups,
                    ForAll(Distinct(Filter(colPeople, Email = User().Email).Group, Group), {Result: ThisRecord.Value}));
        
        // Group IDs of users allowed to approve 
        Set(gblApprovalsGroupsIDs, [7,8,9]);
        Set(gblApprovalActive,
            If(gblUserGroupId_A in gblApprovalsGroupsIDs, true, false));
        
        // Approvals visibility as per user group
        UpdateContext({
            gblCrdCommercialSignoff: false,
            gblCrdControlSignoff: false,
            gblCrdPWAdded: false
        });
        
        
        If(gblUserGroupId_A = 8, UpdateContext({gblCrdCommercialSignoff: true}));
        If(gblUserGroupId_A = 7, UpdateContext({gblCrdControlSignoff: true}));
        If(gblUserGroupId_A = 9, UpdateContext({gblCrdPWAdded: true}));
        /*If(gblUserGroupId_A = 12, UpdateContext({
            gblCrdCommercialSignoff: true,
            gblCrdControlSignoff: true,
            gblCrdPWAdded: true
            }));*/
        
        // User fields vissibility 
        
        UpdateContext({
            gblCrdTitleVis: true,
            gblCrdLevelCalcVis: true,
            gblCrdPAFNumberVis: true,
            gblCrdHomeOrgVis: true,
            gblCrdEmailVis: true,
            gblCrdSMPAEmail: true,
            gblCrdProject: true, 
            gblCrdProjectRole: true,
            gblCrdOfficeLocation: true, 
            gblCrdSCCHeaderVis: true,
            gblCrdAccessGroupVis: true,
            gblCrdStartDateVis: true,
            gblCrdBPSSVis: true, 
            gblCrdExpensesVis: true,
            gblCrdExcessHours: true, 
            gblCrdCommercialCommentsVis: true,
            gblCrdSalleryBandVis: true,
            gblCrdRateVis: true,
            gblCrdCVLinkVis: true, 
            gblCrdPhoneNumberVis: true, 
            gblCrdPhotoLinkVis: true, 
            gblCrdQualificationVis: true,
            gblCrdReleventSchemesVis: true, 
            gblCrdEndDateVis: true,
            gblCrdDemobilistaionVis: true, 
            gblCrdComputerVis: true, 
            gblCrdPWEmailVis: true, 
            gblCrdJacobsUsrVis: true, 
            gblCrdResilienceVis: true,
            gblCrdRequestVis: true,
            gblCrdPWLevel: false,
            gblCrdDiscp: false
        });
        
        If(gblUserGroupId_A = 4,
            UpdateContext({gblCrdCVLinkVis: false, gblCrdPhoneNumberVis: false, glbCrdPhotoLinkVis: false, gblCrdComputerVis: false, gblCrdPWLevelVis: false, 
                            gblCrdJacobsUsrVis: false, gblCrdResilienceVis: false, gblCrdRequestVis: false}));
        
        If(gblUserGroupId_A = 7,
            UpdateContext({gblCrdCVLinkVis: false, gblCrdPhoneNumberVis: false, gblCrdPhotoLinkVis: false, gblCrdQualificationVis: false, gblCrdReleventSchemesVis: false,
                            gblCrdComputerVis: false, gblCrdPWLevelVis: false, gblCrdJacobsUsrVis: false, gblCrdRequestVis: false}));
        
        If(gblUserGroupId_A = 8,
            UpdateContext({gblCrdPAFNumberVis: false, gblCrdOfficeLocation: false, gblCrdSCCHeaderVis: false, gblCrdBPSSVis: false, gblCrdExpensesVis: false, 
                            gblCrdExcessHours: false, gblCrdCVLinkVis: false, gblCrdPhoneNumberVis: false, gblCrdPhotoLinkVis: false, gblCrdQualificationVis: false,
                            gblCrdReleventSchemesVis: false, gblCrdComputerVis: false, gblCrdPWLevelVis: false, gblCrdJacobsUsrVis: false, gblCrdRequestVis: false}));
        
        If(gblUserGroupId_A = 9,
            UpdateContext({gblCrdPAFNumberVis: false, gblCrdOfficeLocation: false, gblCrdSCCHeaderVis: true, gblCrdBPSSVis: false, gblCrdExpensesVis: false, 
                            gblCrdExcessHours: false, gblCrdSalleryBandVis: false, gblCrdRateVis: false, gblCrdCVLinkVis: false, gblCrdPhoneNumberVis: false, 
                            gblCrdPhotoLinkVis: false, gblCrdQualificationVis: false, gblCrdReleventSchemesVis: false, gblCrdResilienceVis: false,
                            gblCrdRequestVis: false, gblCrdPWLevel: true, gblCrdDiscp: true}));
        
        UpdateContext({EmailSentInfo:false});

    btnReject As button:
        BorderColor: =ColorValue(ColorDarkBlue)
        BorderThickness: =0.5
        Color: =ColorValue(ColorWhite)
        DisplayMode: =If(!IsBlank(SelectedPerson_Name) Or SelectedPerson_Name <> "" Or CountRows(colMassiveApproval) > 0, DisplayMode.Edit, DisplayMode.Disabled)
        Fill: =Color.Red
        Font: =Font.Lato
        Height: =31
        HoverColor: =ColorValue(ColorWhite)
        HoverFill: =ColorValue(ColorGray)
        OnSelect: |-
            =If(
                IsBlank(cardEndDateExt.Text),
                Set(EndDateMandat, true); Set(locGreyOutVis, true),
                Set(Reject_UpVis, true); Set(locGreyOutVis, true);
                Set(
                locApprovalText,
                If(
                    gblUserGroupId_A = 7,
                    "Rejected_" & User().Email & "_" & Text(Now(), "[$-en-US]mm/dd/yyyy hh:mm:ss"),
                    gblUserGroupId_A = 8,
                    "Rejected_" & User().Email & "_" & Text(Now(), "[$-en-US]mm/dd/yyyy hh:mm:ss"),
                    gblUserGroupId_A = 9,
                    "Rejected_" & User().Email & "_" & Text(Now(), "[$-en-US]mm/dd/yyyy hh:mm:ss"
                    )
                )
                )
            );
            Reset(txtRejectionNote);
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =12
        Text: ="Reject"
        Visible: =gblApprovalActive And !locMassiveApproval And gblUserGroupId_A = 7
        Width: =144
        X: =1123
        Y: =460
        ZIndex: =1

    shpCenterLineLeft As rectangle:
        Fill: =ColorValue(ColorLightBlue)
        Height: =716
        Width: =2
        X: =585
        Y: =52
        ZIndex: =2

    shpCenterLineRight As rectangle:
        Fill: =ColorValue(ColorLightBlue)
        Height: =718
        Width: =2
        X: =1004
        Y: =50
        ZIndex: =3

    "galPeopleFilters As gallery.'BrowseLayout_Vertical_ThreeTextVariant_ver4.0'":
        BorderColor: =ColorValue(ColorLightBlue)
        Height: =667
        Items: |+
            =// Series of Ifs and filters to apply settings from filtters and search box
            // Starting with if to val if search field is empty
            Filter(If(!IsBlank(txtNameSearch.Text),
            Search(
            
            If(rdoGroup.Selected.Result = Blank() And rdoHomeOrganisation.Selected.Result = Blank() And rdoProject.Selected.Result = Blank(), 
                colPeopleForApproval, 
            If(!IsBlank(rdoGroup.Selected.Result) And rdoHomeOrganisation.Selected.Result = Blank() And rdoProject.Selected.Result = Blank(), 
                Filter(colPeopleForApproval, Discipline = rdoGroup.Selected.Result),
            If(rdoGroup.Selected.Result = Blank() And !IsBlank(rdoHomeOrganisation.Selected.Result) And rdoProject.Selected.Result = Blank(), 
                Filter(colPeopleForApproval, HomeOrganisation = rdoHomeOrganisation.Selected.Result),
            If(rdoGroup.Selected.Result = Blank() And rdoHomeOrganisation.Selected.Result = Blank() And !IsBlank(rdoProject.Selected.Result), 
                Filter(colPeopleForApproval, Project = rdoProject.Selected.Result),
            If(!IsBlank(rdoGroup.Selected.Result) And !IsBlank(rdoHomeOrganisation.Selected.Result) And rdoProject.Selected.Result = Blank(), 
                Filter(colPeopleForApproval, Discipline = rdoGroup.Selected.Result And HomeOrganisation = rdoHomeOrganisation.Selected.Result),
            If(!IsBlank(rdoGroup.Selected.Result) And rdoHomeOrganisation.Selected.Result = Blank() And !IsBlank(rdoProject.Selected.Result), 
                Filter(colPeopleForApproval, Discipline = rdoGroup.Selected.Result And Project = rdoProject.Selected.Result),
            If(rdoGroup.Selected.Result = Blank() And !IsBlank(rdoHomeOrganisation.Selected.Result) And !IsBlank(rdoProject.Selected.Result), 
                Filter(colPeopleForApproval, HomeOrganisation = rdoHomeOrganisation.Selected.Result And Project = rdoProject.Selected.Result),
            If(!IsBlank(rdoGroup.Selected.Result) And !IsBlank(rdoHomeOrganisation.Selected.Result) And !IsBlank(rdoProject.Selected.Result), 
                Filter(colPeopleForApproval, 
                Discipline = rdoGroup.Selected.Result And HomeOrganisation = rdoHomeOrganisation.Selected.Result And Project = rdoProject.Selected.Result))))))))),
                
            txtNameSearch.Text, "Title"),
                
            If(rdoGroup.Selected.Result = Blank() And rdoHomeOrganisation.Selected.Result = Blank() And rdoProject.Selected.Result = Blank(), 
                colPeopleForApproval, 
            If(!IsBlank(rdoGroup.Selected.Result) And rdoHomeOrganisation.Selected.Result = Blank() And rdoProject.Selected.Result = Blank(), 
                Filter(colPeopleForApproval, Discipline = rdoGroup.Selected.Result),
            If(rdoGroup.Selected.Result = Blank() And !IsBlank(rdoHomeOrganisation.Selected.Result) And rdoProject.Selected.Result = Blank(), 
                Filter(colPeopleForApproval, HomeOrganisation = rdoHomeOrganisation.Selected.Result),
            If(rdoGroup.Selected.Result = Blank() And rdoHomeOrganisation.Selected.Result = Blank() And !IsBlank(rdoProject.Selected.Result), 
                Filter(colPeopleForApproval, Project = rdoProject.Selected.Result),
            If(!IsBlank(rdoGroup.Selected.Result) And !IsBlank(rdoHomeOrganisation.Selected.Result) And rdoProject.Selected.Result = Blank(), 
                Filter(colPeopleForApproval, Discipline = rdoGroup.Selected.Result And HomeOrganisation = rdoHomeOrganisation.Selected.Result),
            If(!IsBlank(rdoGroup.Selected.Result) And rdoHomeOrganisation.Selected.Result = Blank() And !IsBlank(rdoProject.Selected.Result), 
                Filter(colPeopleForApproval, Discipline = rdoGroup.Selected.Result And Project = rdoProject.Selected.Result),
            If(rdoGroup.Selected.Result = Blank() And !IsBlank(rdoHomeOrganisation.Selected.Result) And !IsBlank(rdoProject.Selected.Result), 
                Filter(colPeopleForApproval, HomeOrganisation = rdoHomeOrganisation.Selected.Result And Project = rdoProject.Selected.Result),
            If(!IsBlank(rdoGroup.Selected.Result) And !IsBlank(rdoHomeOrganisation.Selected.Result) And !IsBlank(rdoProject.Selected.Result), 
                Filter(colPeopleForApproval, 
                Discipline = rdoGroup.Selected.Result And HomeOrganisation = rdoHomeOrganisation.Selected.Result And Project = rdoProject.Selected.Result)))))))))), !Rej_calc)
            
        Layout: =Layout.Vertical
        OnSelect: =
        TemplatePadding: =0
        TemplateSize: =88
        Width: =360
        X: =225
        Y: =101
        ZIndex: =4

        RectGrayBgSelected_1 As rectangle:
            Fill: =RGBA(230, 230, 230, 1)
            Height: =88
            Visible: =If(ThisItem.ID2 = SelectedPerson_ID, true, false)
            Width: =360
            ZIndex: =1

        Title2 As label:
            Color: =ColorValue(ColorDarkBlue)
            Height: =21
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =12
            Text: =ThisItem.Title
            VerticalAlign: =VerticalAlign.Top
            Width: =273
            X: =32
            Y: =12
            ZIndex: =2

        Subtitle2 As label:
            Color: =ColorValue(ColorBlack)
            Height: =22
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =10
            Text: |-
                ="Discipline: " & ThisItem.Discipline
            VerticalAlign: =VerticalAlign.Top
            Width: =273
            X: =32
            Y: =Title2.Y + Title2.Height + 1
            ZIndex: =3

        Body2 As label:
            Color: =ColorValue(ColorBlack)
            Height: =23
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =10
            Text: |-
                ="Project: " & ThisItem.Project
            VerticalAlign: =VerticalAlign.Top
            Width: =273
            X: =32
            Y: =Subtitle2.Y + Subtitle2.Height + 1
            ZIndex: =4

        NextArrow2 As icon.ChevronRight:
            AccessibleLabel: =Self.Tooltip
            Color: =ColorValue(ColorLightBlue)
            Height: =60
            HoverColor: =ColorValue(ColorGray)
            Icon: =Icon.ChevronRight
            OnSelect: |-
                =// Set variable for gallery look up
                Set(SelectedPerson_ID, ThisItem.ID2);
                Set(SelectedPerson_Name, ThisItem.Title);
                Set(locRequestorEmail, ThisItem.Email);
                Set(locRequestorProject, ThisItem.Project);
                Set(locRequestorLevel, ThisItem.Level_Calc);
                Set(locRequestorSalaryBand, ThisItem.SalaryBand);
                Set(locRequestorEndDate, ThisItem.EndDate);
                
                
                // Create new PAF number
                Set(SelectedPAF, ThisItem.PAFNumber);
                If(Len(SelectedPAF)=7,Set(LatestRevision, Right(SelectedPAF, 1)));  // Get current Revision
                If(Len(SelectedPAF)=8,Set(LatestRevision, Right(SelectedPAF, 2)));
                Set(NewRevision, Text(Value(LatestRevision)+1));
                Set(NewPAFNumber, Left(SelectedPAF, 6) & NewRevision);
                
                Set(locSelectedPersonStartDate, ThisItem.StartDate);
                Set(locSelectedPersonEndDate, ThisItem.EndDate);
                
                Set(locSelectedPersonProject, ThisItem.Project);
                Set(locSelectedPersonHomeOrg, ThisItem.HomeOrganisation);
                Set(locSelectedPersonProductionHub, ThisItem.ProductionHub);
                Set(locSelectedPersonSCCHeader, ThisItem.SCCHeader);
                Set(locSelectedPersonRequestor, ThisItem.Requester);
                
                
                Set(locRequestorToDisplay, ThisItem.Requester);
                If( SelectedPerson_Name in locRequestorToDisplay, 
                
                    // "PAFTitle - PAF/RequestorEmail"  -> "email"
                        Set(locRequestorToDisplay, Substitute(locRequestorToDisplay, SelectedPerson_Name, ""));
                        Set(locRequestorToDisplay, Substitute(locRequestorToDisplay, " - ", "")),
                    
                    // "RequestorTitle PAFEmail"  -> "RequestorTitle"
                    If(locRequestorEmail in locSelectedPersonRequestor && !(SelectedPerson_Name in locSelectedPersonRequestor),
                        Set(locRequestorToDisplay, Substitute(locRequestorToDisplay, locRequestorEmail, ""));
                        Set(locRequestorToDisplay, Substitute(locRequestorToDisplay, " - ", ""))));
                
                
                
                // old requestor display 
                /*
                    // "RequestorTitle
                    //If("-" in locSelectedPersonRequestor,
                    //    Set(locRequestorToDisplay, Substitute(locRequestorToDisplay, "-", "")),
                
                
                
                
                    // Requestor == "RequestorTitleRequestorEmail" -> "email"     
                    If( Lower(Replace(Substitute(Substitute(First(ForAll(Split(locSelectedPersonRequestor,"@"), {Result: ThisRecord.Value})).Result,".", "")," ",""),1,Len(Substitute(Substitute(First(ForAll(Split(ThisItem.Requester,"@"), {Result: ThisRecord.Value})).Result,".", "")," ",""))/2,         ""))= Lower(Replace(Substitute(Substitute(First(ForAll(Split(locSelectedPersonRequestor,"@"), {Result: ThisRecord.Value})).Result,".", "")," ",""),Len(Substitute(Substitute(First(ForAll(Split(ThisItem.Requester,"@"), {Result: ThisRecord.Value})).Result,".", "")," ",""))        /2+1,Len(Substitute(Substitute(First(ForAll(Split(ThisItem.Requester,"@"), {Result: ThisRecord.Value})).Result,".", "")," ","")),"")),  
                                
                        Replace(locRequestorToDisplay, 1, Len(Substitute(First(ForAll(Split(locRequestorToDisplay,"@"), {Result: ThisRecord.Value})).Result,".", ""))/2+1, ""),
                        
                        ThisItem.Requester)));
                */
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            TabIndex: =0
            Tooltip: ="View item details"
            Width: =60
            X: =Parent.TemplateWidth - Self.Width - 5
            Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
            ZIndex: =5

        Separator2 As rectangle:
            BorderColor: =RGBA(237, 237, 237, 1)
            BorderThickness: =0.5
            Fill: =RGBA(0, 0, 0, 0)
            Height: =1
            OnSelect: =Select(Parent)
            Width: =Parent.TemplateWidth
            Y: =Parent.TemplateHeight - 1
            ZIndex: =6

        Checkbox2_1 As checkbox:
            CheckboxSize: =25
            Default: =If(ThisItem.ID2 in galMassiveApproval.AllItems.ID2, true, false)
            Height: =27
            OnCheck: =Collect(colMassiveApproval, ThisItem)
            OnUncheck: =Remove(colMassiveApproval, ThisItem)
            Size: =8
            Text: =""
            Visible: =locMassiveApproval
            Width: =21
            X: =4
            Y: =10
            ZIndex: =7

    shpFiltersBackground As rectangle:
        BorderColor: =RGBA(0, 0, 0, 0)
        Fill: =ColorValue(ColorLightBlue)
        Height: =718
        Width: =225
        Y: =50
        ZIndex: =5

    lblAllFilters As label:
        Color: =ColorValue(ColorWhite)
        Font: =Font.Lato
        FontWeight: =FontWeight.Bold
        Height: =31
        PaddingBottom: =0
        PaddingLeft: =0
        PaddingRight: =0
        PaddingTop: =0
        Size: =12
        Text: ="Filters"
        Width: =130
        X: =26
        Y: =124
        ZIndex: =6

    rdoProject As radio:
        Color: =ColorValue(ColorWhite)
        Default: =Blank()
        Font: =Font.Lato
        HoverColor: =ColorValue(ColorGray)
        Items: |
            =//Distinct(colPeopleForApproval, Project)
            
            
            ForAll(Distinct(
                If(
                   Text(First(gblUserHomeOrg.Result).Result) <> "All",
                    Filter(
                        projectFilter,
                        HomeOrganisation = Text(First(gblUserHomeOrg.Result).Result)
                    ),
                    projectFilter
                ),
                Project
            ), {Result: ThisRecord.Value})
        LineHeight: =1.5
        PaddingBottom: =0
        PaddingTop: =0
        RadioBorderColor: =RGBA(116, 116, 116, 1)
        RadioSize: =18
        Size: =8
        Width: =213
        Y: =193
        ZIndex: =7

    rdoHomeOrganisation As radio:
        Color: =ColorValue(ColorWhite)
        Default: =Blank()
        Font: =Font.Lato
        Height: =70
        HoverColor: =ColorValue(ColorGray)
        Items: |-
            =ForAll(Distinct(colPeopleForApproval, HomeOrganisation), {Result: ThisRecord.Value})
        LineHeight: =1.5
        PaddingBottom: =0
        PaddingTop: =0
        RadioBorderColor: =RGBA(116, 116, 116, 1)
        RadioSize: =18
        Size: =8
        Width: =213
        Y: =340
        ZIndex: =8

    rdoGroup As radio:
        Color: =ColorValue(ColorWhite)
        Default: =Blank()
        Font: =Font.Lato
        Height: =213
        HoverColor: =ColorValue(ColorGray)
        Items: |-
            =ForAll(Distinct(colPeopleForApproval, Discipline), {Result: ThisRecord.Value})
        LineHeight: =1.5
        PaddingBottom: =0
        PaddingTop: =0
        RadioBorderColor: =RGBA(116, 116, 116, 1)
        RadioSize: =18
        Size: =8
        Width: =213
        Y: =460
        ZIndex: =9

    txtNameSearch As text:
        BorderColor: =ColorValue(ColorLightBlue)
        BorderThickness: =1
        Default: =""
        Height: =50
        HintText: ="Search Name"
        HoverBorderColor: =ColorValue(ColorLightBlue)
        HoverFill: =ColorValue(ColorGray)
        Italic: =true
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =10
        Width: =314
        X: =225
        Y: =50
        ZIndex: =10

    btnClearprojects As button:
        BorderColor: =ColorValue(ColorWhite)
        BorderThickness: =1
        Color: =ColorValue(ColorWhite)
        Fill: =RGBA(0, 0, 0, 0)
        Font: =Font.Lato
        FontWeight: =FontWeight.Lighter
        Height: =23
        HoverColor: =ColorValue(ColorGray)
        HoverFill: =
        OnSelect: |-
            =// Reseting project radio on click
            
            Reset(rdoProject)
        PaddingBottom: =1
        PaddingLeft: =1
        PaddingRight: =1
        PaddingTop: =1
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =10
        Text: ="Clear"
        Width: =46
        X: =167
        Y: =160
        ZIndex: =11

    lblProjects As label:
        Color: =ColorValue(ColorWhite)
        Font: =Font.Lato
        FontWeight: =FontWeight.Bold
        Height: =31
        PaddingBottom: =0
        PaddingLeft: =0
        PaddingRight: =0
        PaddingTop: =0
        Size: =10
        Text: ="Projects"
        Underline: =true
        Width: =130
        X: =26
        Y: =155
        ZIndex: =12

    lblHome As label:
        Color: =ColorValue(ColorWhite)
        Font: =Font.Lato
        FontWeight: =FontWeight.Bold
        Height: =31
        PaddingBottom: =0
        PaddingLeft: =0
        PaddingRight: =0
        PaddingTop: =0
        Size: =10
        Text: ="Home Organisation"
        Underline: =true
        Width: =130
        X: =26
        Y: =305
        ZIndex: =13

    lblDiscipline As label:
        Color: =ColorValue(ColorWhite)
        Font: =Font.Lato
        FontWeight: =FontWeight.Bold
        Height: =31
        PaddingBottom: =0
        PaddingLeft: =0
        PaddingRight: =0
        PaddingTop: =0
        Size: =10
        Text: ="Discipline"
        Underline: =true
        Width: =130
        X: =26
        Y: =424
        ZIndex: =14

    btnClearTextSearch As button:
        BorderColor: =Color.White
        BorderThickness: =0
        Color: =ColorValue(ColorWhite)
        Fill: =ColorValue(ColorGray)
        Font: =Font.Lato
        FontWeight: =FontWeight.Lighter
        Height: =51
        HoverColor: =ColorValue(ColorWhite)
        HoverFill: =ColorValue(ColorLightBlue)
        OnSelect: |-
            =// Reseting HomeOrganization radio on click
            
            Reset(txtNameSearch)
        PaddingBottom: =1
        PaddingLeft: =1
        PaddingRight: =1
        PaddingTop: =1
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =10
        Text: ="Clear"
        Width: =46
        X: =539
        Y: =50
        ZIndex: =15

    Label4 As label:
        Height: =96
        Text: ="No item to display. Select one of the users from the gallery"
        Visible: =If(IsBlank(SelectedPerson_Name) Or SelectedPerson_Name = "", true, false)
        Width: =259
        X: =676
        Y: =336
        ZIndex: =20

    btnClearHome As button:
        BorderColor: =ColorValue(ColorWhite)
        BorderThickness: =1
        Color: =ColorValue(ColorWhite)
        Fill: =RGBA(0, 0, 0, 0)
        Font: =Font.Lato
        FontWeight: =FontWeight.Lighter
        Height: =23
        HoverColor: =ColorValue(ColorGray)
        HoverFill: =
        OnSelect: |-
            =// Reseting project radio on click
            
            Reset(rdoHomeOrganisation)
        PaddingBottom: =1
        PaddingLeft: =1
        PaddingRight: =1
        PaddingTop: =1
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =10
        Text: ="Clear"
        Width: =46
        X: =167
        Y: =309
        ZIndex: =30

    btnClearDiscipline As button:
        BorderColor: =ColorValue(ColorWhite)
        BorderThickness: =1
        Color: =ColorValue(ColorWhite)
        Fill: =RGBA(0, 0, 0, 0)
        Font: =Font.Lato
        FontWeight: =FontWeight.Lighter
        Height: =23
        HoverColor: =ColorValue(ColorGray)
        HoverFill: =
        OnSelect: |-
            =// Reseting project radio on click
            
            Reset(rdoGroup)
        PaddingBottom: =1
        PaddingLeft: =1
        PaddingRight: =1
        PaddingTop: =1
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =10
        Text: ="Clear"
        Width: =46
        X: =167
        Y: =429
        ZIndex: =31

    btnClearAllfilters As button:
        BorderColor: =ColorValue(ColorWhite)
        BorderThickness: =1
        Color: =ColorValue(ColorWhite)
        Fill: =RGBA(0, 0, 0, 0)
        Font: =Font.Lato
        FontWeight: =FontWeight.Lighter
        Height: =23
        HoverColor: =ColorValue(ColorGray)
        HoverFill: =
        OnSelect: |-
            =// Reseting project radio on click
            
            Reset(rdoProject);
            Reset(rdoHomeOrganisation);
            Reset(rdoGroup)
        PaddingBottom: =1
        PaddingLeft: =1
        PaddingRight: =1
        PaddingTop: =1
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =10
        Text: ="Clear all filters"
        Width: =167
        X: =23
        Y: =690
        ZIndex: =32

    lblApprovalTop As label:
        Align: =Align.Center
        Color: =ColorValue(ColorWhite)
        Fill: =ColorValue(ColorLightBlue)
        Font: =Font.Lato
        FontWeight: =FontWeight.Bold
        Height: =51
        Text: ="Approval details"
        Width: =417
        X: =949
        Y: =50
        ZIndex: =34

    vevApprovalForm As form:
        AcceptsFocus: =false
        DataSource: =SMA_AT5
        DefaultMode: =FormMode.View
        Height: =59
        Item: =LookUp(SMA_AT5, ID2=SelectedPerson_ID)
        NumberOfColumns: =1
        Width: =360
        X: =1006
        Y: =If(locMassiveApproval, 185, 365)
        ZIndex: =35

        crdCommercialSignoff_Appr As typedDataCard.textualEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="CommercialSignoff"
            Default: =ThisItem.CommercialSignoff
            DisplayMode: =Parent.DisplayMode
            DisplayName: ="CommercialSignoff"
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            MaxLength: =DataSourceInfo(SMA_AT5, DataSourceInfo.MaxLength, "CommercialSignoff")
            Required: =false
            Update: =DataCardValue16.Text
            Visible: =gblCrdCommercialSignoff
            Width: =366
            X: =0
            Y: =0
            ZIndex: =1

            DataCardKey16 As label:
                Color: =ColorValue(ColorBlack)
                Font: =ApprovalKeyFont
                Size: =ApprovalKeyFontSize
                Text: |-
                    ="Project Accountant Approval:"
                Width: =226
                Wrap: =false
                X: =48
                ZIndex: =1

            DataCardValue16 As text:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                Color: =ApprovalValueFontColor
                Default: =If(StartsWith(ThisItem.CommercialSignoff,"Approve"),"Yes","No")
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                Font: =ApprovalValueFont
                MaxLength: =Parent.MaxLength
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =ApprovalValueFontSize
                Tooltip: =Parent.DisplayName
                Width: =69
                X: =274
                ZIndex: =2

        crdControlSignoff_Appr As typedDataCard.textualEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="ControlSignoff"
            Default: =ThisItem.ControlSignoff
            DisplayMode: =Parent.DisplayMode
            DisplayName: ="ControlSignoff"
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            MaxLength: =DataSourceInfo(SMA_AT5, DataSourceInfo.MaxLength, "ControlSignoff")
            Required: =false
            Update: =DataCardValue17.Text
            Visible: =gblCrdControlSignoff
            Width: =366
            X: =0
            Y: =1
            ZIndex: =1

            DataCardKey17 As label:
                Color: =ApprovalKeyFontColor
                Size: =ApprovalKeyFontSize
                Text: |-
                    ="Project Control Approval:"
                Width: =ApprovalKeyW
                Wrap: =false
                X: =50
                ZIndex: =1

            DataCardValue17 As text:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                Color: =ApprovalValueFontColor
                Default: =If(StartsWith(ThisItem.ControlSignoff,"Added"),"Yes","No")
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                Font: =ApprovalValueFont
                MaxLength: =Parent.MaxLength
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =ApprovalValueFontSize
                Tooltip: =Parent.DisplayName
                Width: =81
                X: =263
                ZIndex: =2

        crdPWAdded_Appr As typedDataCard.textualEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="PWAdded"
            Default: =ThisItem.PWAdded
            DisplayMode: =Parent.DisplayMode
            DisplayName: ="PWAdded"
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            MaxLength: =DataSourceInfo(SMA_AT5, DataSourceInfo.MaxLength, "PWAdded")
            Required: =false
            Update: =DataCardValue18.Text
            Visible: =gblCrdPWAdded
            Width: =366
            X: =0
            Y: =2
            ZIndex: =1

            DataCardKey18 As label:
                Color: =ApprovalKeyFontColor
                Height: =50
                Size: =ApprovalKeyFontSize
                Text: |-
                    ="ProjectWise Team Added:"
                Width: =236
                Wrap: =false
                X: =64
                Y: =ApprovalKeyY
                ZIndex: =1

            DataCardValue18 As text:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                Color: =ApprovalValueFontColor
                Default: =If(StartsWith(ThisItem.PWAdded,"Add"),"Yes","No")
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                Font: =ApprovalValueFont
                Height: =50
                MaxLength: =Parent.MaxLength
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =ApprovalValueFontSize
                Tooltip: =Parent.DisplayName
                Width: =54
                X: =272
                Y: =ApprovalValueY
                ZIndex: =2

    btnApproval As button:
        BorderColor: =ColorValue(ColorDarkBlue)
        BorderThickness: =0.5
        Color: =ColorValue(ColorWhite)
        DisplayMode: =If(!IsBlank(SelectedPerson_Name) Or SelectedPerson_Name <> "" Or CountRows(colMassiveApproval) > 0, DisplayMode.Edit, DisplayMode.Disabled)
        Fill: =ColorValue(ColorLightBlue)
        Font: =Font.Lato
        Height: =31
        HoverColor: =ColorValue(ColorWhite)
        HoverFill: =ColorValue(ColorGray)
        OnSelect: |
            =If(
                // if
                IsBlank(cardEndDateExt.Text) || cardProject.Text="Not applicable" || DateDiff(DateValue(cardStartDate.Text),DateValue(cardEndDateExt.Text))<0 || IsBlank(cardEmail.Text) || Not("@" in cardEmail.Text) , 
                // true
                Set(EndDateMandat, true); Set(locGreyOutVis, true),
                //else
                Set(ApprovalPop_UpVis, true); Set(locGreyOutVis, true);
                Set(
                locApprovalText,
                If(
                    gblUserGroupId_A = 7,
                    "Approved_" & User().Email & "_" & Text(Now(), "[$-en-US]mm/dd/yyyy hh:mm:ss"),
                    gblUserGroupId_A = 8,
                    "Approved_" & User().Email & "_" & Text(Now(), "[$-en-US]mm/dd/yyyy hh:mm:ss"),
                    gblUserGroupId_A = 9,
                    "Approved_" & User().Email & "_" & Text(Now(), "[$-en-US]mm/dd/yyyy hh:mm:ss"
                    )
                )
                )
            );
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =12
        Text: ="Approve"
        Visible: =gblApprovalActive
        Width: =144
        X: =1123
        Y: =If(locMassiveApproval, 713, 421)
        ZIndex: =36

    grpDetailsMain As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =36

        frmDetails As form:
            AcceptsFocus: =false
            DataSource: =SMA_AT5
            DefaultMode: =DetailsFormMode
            Height: =631
            Item: =LookUp(SMA_AT5, ID2=SelectedPerson_ID)
            NumberOfColumns: =1
            OnSuccess: =
            SnapToColumns: =false
            Visible: =If(IsBlank(SelectedPerson_Name) Or SelectedPerson_Name = "", false, true)
            Width: =419
            X: =585
            Y: =101
            ZIndex: =26

            crdPAFNumber_Main As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="PAFNumber"
                Default: =ThisItem.PAFNumber
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="PAF Number"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =40
                MaxLength: =DataSourceInfo(SMA_AT5, DataSourceInfo.MaxLength, "PAFNumber")
                Required: =false
                Update: =cardPAFNumber.Text
                Visible: =gblCrdPAFNumberVis
                Width: =408
                WidthFit: =true
                X: =0
                Y: =0
                ZIndex: =1

                DataCardKey60 As label:
                    AutoHeight: =true
                    Color: =ColorValue(ColorDarkBlue)
                    Font: =DisplayKeyFont
                    Height: =DisplayKeyH
                    Size: =DisplayKeyFontSize
                    Text: =Parent.DisplayName
                    Width: =DisplayKeyW
                    Wrap: =false
                    X: =DisplayKeyX
                    Y: =11
                    ZIndex: =1

                cardPAFNumber As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =DisplayValueBorderThick
                    Color: =ColorValue(DisplayValueColor)
                    Default: =If(Parent.DisplayMode = DisplayMode.View, Parent.Default, NewPAFNumber)
                    DelayOutput: =true
                    DisplayMode: =DisplayMode.View
                    Font: =DisplayValueFont
                    Height: =DisplayValueH
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =DisplayValueFontSize
                    Tooltip: =Parent.DisplayName
                    Width: =DisplayValueW
                    X: =170
                    Y: =5
                    ZIndex: =2

                ErrorMessage57 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =cardPAFNumber.Y + cardPAFNumber.Height
                    ZIndex: =3

                StarVisible57 As label:
                    Align: =Align.Center
                    Height: =DataCardKey60.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey60.Y
                    ZIndex: =4

            Title_DataCard2 As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="Title"
                Default: =ThisItem.Title
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@SMA_AT5],DataSourceInfo.DisplayName,"Title")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =DisplayValueH
                MaxLength: =DataSourceInfo([@SMA_AT5], DataSourceInfo.MaxLength, "Title")
                Required: =false
                Update: =DataCardValue60.Text
                Visible: |-
                    =If(
                        gblUserGroupId_A = 7,
                        true,
                        false
                    )
                Width: =408
                X: =1
                Y: =0
                ZIndex: =1

                DataCardKey79 As label:
                    AutoHeight: =true
                    Color: =ColorValue(ColorDarkBlue)
                    Font: =Font.Arial
                    Height: =25
                    Size: =10
                    Text: ="Name"
                    Width: =107
                    Wrap: =false
                    X: =13
                    Y: =7
                    ZIndex: =1

                DataCardValue60 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =0.5
                    Color: =ColorValue(DisplayValueColor)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =Font.Arial
                    Height: =DisplayValueH
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =DisplayValueFontSize
                    Tooltip: =Parent.DisplayName
                    Width: =210
                    X: =170
                    Y: =1
                    ZIndex: =2

                ErrorMessage63 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue60.Y + DataCardValue60.Height
                    ZIndex: =3

                StarVisible64 As label:
                    Align: =Align.Center
                    Height: =DataCardKey79.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey79.Y
                    ZIndex: =4

            Preferred_Name_DataCard3 As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="Preferred_Name"
                Default: =ThisItem.Preferred_Name
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@SMA_AT5],DataSourceInfo.DisplayName,"Preferred_Name")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =CardH
                MaxLength: =DataSourceInfo([@SMA_AT5], DataSourceInfo.MaxLength, "Preferred_Name")
                Required: =false
                Update: =DataCardValue69.Text
                Visible: =If(gblUserGroupId_A = 7, true, false)
                Width: =419
                X: =2
                Y: =0
                ZIndex: =1

                DataCardKey73 As label:
                    AutoHeight: =true
                    Color: =ColorValue(ColorDarkBlue)
                    Font: =DisplayKeyFont
                    Height: =34
                    Size: =DisplayKeyFontSize
                    Text: ="Preffered Name"
                    Width: =(Parent.Width - 60) * 0.4
                    Wrap: =false
                    X: =DisplayKeyX
                    Y: =DisplayKeyY
                    ZIndex: =1

                DataCardValue69 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =0.5
                    Color: =ColorValue(DisplayValueColor)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =Font.Arial
                    Height: =DisplayValueH
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =10
                    Tooltip: =Parent.DisplayName
                    Width: =210
                    X: =170
                    ZIndex: =2

                ErrorMessage46 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue69.Y + DataCardValue69.Height
                    ZIndex: =3

                StarVisible66 As label:
                    Align: =Align.Center
                    Height: =DataCardKey73.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey73.Y
                    ZIndex: =4

            crdHomeOrg_Main As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="HomeOrganisation"
                Default: =ThisItem.HomeOrganisation
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Home Org."
                Fill: =RGBA(0, 0, 0, 0)
                Height: =CardH
                MaxLength: =DataSourceInfo(SMA_AT5, DataSourceInfo.MaxLength, "HomeOrganisation")
                Required: =false
                Update: =cardHomeOrg.Text
                Visible: =gblCrdHomeOrgVis
                Width: =408
                WidthFit: =true
                X: =3
                Y: =0
                ZIndex: =1

                DataCardKey37 As label:
                    AutoHeight: =true
                    Color: =ColorValue(ColorDarkBlue)
                    Font: =DisplayKeyFont
                    Height: =26
                    Size: =DisplayKeyFontSize
                    Text: ="Partner Organisation"
                    Width: =135
                    Wrap: =false
                    X: =DisplayKeyX
                    Y: =DisplayKeyY
                    ZIndex: =1

                cardHomeOrg As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =DisplayValueBorderThick
                    Color: =ColorValue(DisplayValueColor)
                    Default: =locSelectedPersonHomeOrg
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =DisplayValueFont
                    Height: =DisplayValueH
                    MaxLength: =Parent.MaxLength
                    OnSelect: |-
                        =Set(pupHomeOrgPicker, true);
                        Set(locGreyOutVis,true);
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =DisplayValueFontSize
                    Tooltip: =Parent.DisplayName
                    Width: =DisplayValueW
                    X: =170
                    ZIndex: =2

                ErrorMessage35 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =cardHomeOrg.Y + cardHomeOrg.Height
                    ZIndex: =3

                StarVisible35 As label:
                    Align: =Align.Center
                    Height: =DataCardKey37.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey37.Y
                    ZIndex: =4

            crdReleventSchemes_Main As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="ReleventSchemes"
                Default: =ThisItem.ReleventSchemes
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Relevent Schemes"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =CardH
                MaxLength: =DataSourceInfo(SMA_AT5, DataSourceInfo.MaxLength, "ReleventSchemes")
                Required: =false
                Update: =DataCardValue82.Text
                Visible: =gblCrdReleventSchemesVis
                Width: =415
                WidthFit: =true
                X: =4
                Y: =0
                ZIndex: =1

                DataCardKey80 As label:
                    AutoHeight: =true
                    Color: =ColorValue(DisplayKeyColor)
                    Font: =DisplayKeyFont
                    Height: =DisplayKeyH
                    Size: =DisplayKeyFontSize
                    Text: =Parent.DisplayName
                    Width: =DisplayKeyW
                    Wrap: =false
                    X: =DisplayKeyX
                    Y: =DisplayKeyY
                    ZIndex: =1

                DataCardValue82 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =DisplayValueBorderThick
                    Color: =ColorValue(DisplayValueColor)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =DisplayValueFont
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =DisplayValueFontSize
                    Tooltip: =Parent.DisplayName
                    Width: =DisplayValueW
                    X: =DisplayValueX
                    Y: =DisplayValueY
                    ZIndex: =2

                ErrorMessage77 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue82.Y + DataCardValue82.Height
                    ZIndex: =3

                StarVisible77 As label:
                    Align: =Align.Center
                    Height: =DataCardKey80.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey80.Y
                    ZIndex: =4

            crdSCCHeader_Main As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="SCCHeader"
                Default: =ThisItem.SCCHeader
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="SCC Header"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =CardH
                MaxLength: =DataSourceInfo(SMA_AT5, DataSourceInfo.MaxLength, "SCCHeader")
                Required: =false
                Update: =cardSCCHeader.Text
                Visible: =gblCrdSCCHeaderVis
                Width: =415
                WidthFit: =true
                X: =5
                Y: =0
                ZIndex: =1

                DataCardKey86 As label:
                    AutoHeight: =true
                    Color: =ColorValue(ColorDarkBlue)
                    Font: =DisplayKeyFont
                    Height: =DisplayKeyH
                    Size: =DisplayKeyFontSize
                    Text: ="Residency"
                    Width: =DisplayKeyW
                    Wrap: =false
                    X: =DisplayKeyX
                    Y: =DisplayKeyY
                    ZIndex: =1

                cardSCCHeader As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =DisplayValueBorderThick
                    Color: =ColorValue(DisplayValueColor)
                    Default: =locSelectedPersonSCCHeader
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =DisplayValueFont
                    Height: =DisplayValueH
                    MaxLength: =Parent.MaxLength
                    OnSelect: |-
                        =Set(pupSCCHeaderPicker, true);
                        Set(locGreyOutVis,true);
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =DisplayValueFontSize
                    Tooltip: =Parent.DisplayName
                    Width: =DisplayValueW
                    X: =170
                    ZIndex: =2

                ErrorMessage83 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =cardSCCHeader.Y + cardSCCHeader.Height
                    ZIndex: =3

                StarVisible83 As label:
                    Align: =Align.Center
                    Height: =DataCardKey86.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey86.Y
                    ZIndex: =4

            crdOfficeLocation_Main As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="OfficeLocation"
                Default: =ThisItem.OfficeLocation
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Office Location"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =CardH
                MaxLength: =DataSourceInfo(SMA_AT5, DataSourceInfo.MaxLength, "OfficeLocation")
                Required: =false
                Update: =cardOfficeLoc.Text
                Visible: =gblCrdOfficeLocation
                Width: =415
                WidthFit: =true
                X: =6
                Y: =0
                ZIndex: =1

                DataCardKey58 As label:
                    Color: =ColorValue(ColorDarkBlue)
                    Font: =DisplayKeyFont
                    Size: =DisplayKeyFontSize
                    Text: |-
                        ="Office / 
                        Country Location"
                    Width: =166
                    Wrap: =false
                    X: =DisplayKeyX
                    ZIndex: =1

                cardOfficeLoc As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =DisplayValueBorderThick
                    Color: =ColorValue(DisplayValueColor)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =DisplayValueFont
                    Height: =DisplayValueH
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =DisplayValueFontSize
                    Tooltip: =Parent.DisplayName
                    Width: =DisplayValueW
                    X: =170
                    ZIndex: =2

                ErrorMessage55 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =cardOfficeLoc.Y + cardOfficeLoc.Height
                    ZIndex: =3

                StarVisible55 As label:
                    Align: =Align.Center
                    Height: =DataCardKey58.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey58.Y
                    ZIndex: =4

            crdEmail_Main As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="Email"
                Default: =ThisItem.Email
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Email"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =CardH
                MaxLength: =DataSourceInfo(SMA_AT5, DataSourceInfo.MaxLength, "Email")
                Required: =false
                Update: =cardEmail.Text
                Visible: =gblCrdEmailVis
                Width: =415
                WidthFit: =true
                X: =7
                Y: =0
                ZIndex: =1

                DataCardKey26 As label:
                    Color: =ColorValue(ColorDarkBlue)
                    Font: =DisplayKeyFont
                    Height: =26
                    Size: =DisplayKeyFontSize
                    Text: ="Partner Email Address"
                    Width: =156
                    Wrap: =false
                    X: =DisplayKeyX
                    Y: =DisplayKeyY
                    ZIndex: =1

                cardEmail As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =DisplayValueBorderThick
                    Color: =ColorValue(DisplayValueColor)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =DisplayValueFont
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =DisplayValueFontSize
                    Tooltip: =Parent.DisplayName
                    Width: =DisplayValueW
                    X: =170
                    ZIndex: =2

                ErrorMessage24 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =cardEmail.Y + cardEmail.Height
                    ZIndex: =3

                StarVisible24 As label:
                    Align: =Align.Center
                    Height: =DataCardKey26.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey26.Y
                    ZIndex: =4

            Discipline_DataCard2 As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="Discipline"
                Default: =ThisItem.Discipline
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@SMA_AT5],DataSourceInfo.DisplayName,"Discipline")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =CardH
                MaxLength: =DataSourceInfo([@SMA_AT5], DataSourceInfo.MaxLength, "Discipline")
                Required: =false
                Update: =DataCardValue76.Text
                Visible: =If(gblUserGroupId_A=9, true, false)
                Width: =419
                X: =8
                Y: =0
                ZIndex: =1

                DataCardKey89 As label:
                    AutoHeight: =true
                    Color: =ColorValue(ColorDarkBlue)
                    Font: =Font.Arial
                    Height: =DisplayKeyH
                    Size: =10
                    Text: =Parent.DisplayName
                    Width: =DisplayKeyW
                    Wrap: =false
                    X: =DisplayKeyX
                    Y: =DisplayKeyY
                    ZIndex: =1

                DataCardValue76 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =0.2
                    Color: =ColorValue(DisplayValueColor)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =Font.Arial
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =10
                    Tooltip: =Parent.DisplayName
                    Width: =DisplayValueW
                    X: =170
                    Y: =1
                    ZIndex: =2

                ErrorMessage73 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue76.Y + DataCardValue76.Height
                    ZIndex: =3

                StarVisible78 As label:
                    Align: =Align.Center
                    Height: =DataCardKey89.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey89.Y
                    ZIndex: =4

            crdProject_Main As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="Project"
                Default: =ThisItem.Project
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Project"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =CardH
                MaxLength: =DataSourceInfo(SMA_AT5, DataSourceInfo.MaxLength, "Project")
                Required: =false
                Update: =cardProject.Text
                Visible: =gblCrdProject
                Width: =415
                WidthFit: =true
                X: =9
                Y: =0
                ZIndex: =1

                DataCardKey68 As label:
                    Color: =ColorValue(ColorDarkBlue)
                    Font: =DisplayKeyFont
                    Size: =DisplayKeyFontSize
                    Text: |-
                        ="Scheme/ Project/ 
                        Production Hub"
                    Width: =190
                    Wrap: =false
                    X: =DisplayKeyX
                    ZIndex: =1

                cardProject As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =DisplayValueBorderThick
                    Color: =ColorValue(DisplayValueColor)
                    Default: =locSelectedPersonProject
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =DisplayValueFont
                    Height: =DisplayValueH
                    MaxLength: =Parent.MaxLength
                    OnSelect: |-
                        =Set(pupProjectPicker, true);
                        Set(locGreyOutVis,true);
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =DisplayValueFontSize
                    Tooltip: =Parent.DisplayName
                    Width: =DisplayValueW
                    X: =170
                    ZIndex: =2

                ErrorMessage65 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =cardProject.Y + cardProject.Height
                    ZIndex: =3

                StarVisible65 As label:
                    Align: =Align.Center
                    Height: =DataCardKey68.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey68.Y
                    ZIndex: =4

            ProductionHub_DataCard1 As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="ProductionHub"
                Default: =ThisItem.ProductionHub
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@SMA_AT5],DataSourceInfo.DisplayName,"ProductionHub")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =CardH
                MaxLength: =DataSourceInfo([@SMA_AT5], DataSourceInfo.MaxLength, "ProductionHub")
                Required: =false
                Update: =DataCardValue14.Text
                Visible: =If(ThisItem.Project="Production Hub", true, false)
                Width: =419
                X: =10
                Y: =0
                ZIndex: =1

                DataCardKey21 As label:
                    AutoHeight: =true
                    Color: =ColorValue(ColorDarkBlue)
                    Font: =Font.Arial
                    Height: =DisplayKeyH
                    Size: =10
                    Text: ="Team"
                    Width: =DisplayKeyW
                    Wrap: =false
                    X: =DisplayKeyX
                    Y: =DisplayKeyY
                    ZIndex: =1

                DataCardValue14 As text:
                    BorderColor: =ColorValue(ColorDarkBlue)
                    BorderThickness: =0.5
                    Color: =ColorValue(DisplayValueColor)
                    Default: =locSelectedPersonProductionHub
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =Font.Arial
                    Height: =DisplayValueH
                    MaxLength: =Parent.MaxLength
                    OnSelect: |-
                        =Set(pupProdHubPicker, true);
                        Set(locGreyOutVis,true);
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =10
                    Tooltip: =Parent.DisplayName
                    Width: =DisplayValueW
                    X: =170
                    ZIndex: =2

                ErrorMessage49 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue14.Y + DataCardValue14.Height
                    ZIndex: =3

                StarVisible69 As label:
                    Align: =Align.Center
                    Height: =DataCardKey21.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey21.Y
                    ZIndex: =4

            crdProjectRole_Main As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="ProjectRole"
                Default: =ThisItem.ProjectRole
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Project Role"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =CardH
                MaxLength: =DataSourceInfo(SMA_AT5, DataSourceInfo.MaxLength, "ProjectRole")
                Required: =false
                Update: =cardProjRole.Text
                Visible: =gblCrdProjectRole
                Width: =415
                WidthFit: =true
                X: =1
                Y: =1
                ZIndex: =1

                DataCardKey70 As label:
                    AutoHeight: =true
                    Color: =ColorValue(ColorDarkBlue)
                    Font: =DisplayKeyFont
                    Height: =DisplayKeyH
                    Size: =DisplayKeyFontSize
                    Text: =Parent.DisplayName
                    Width: =DisplayKeyW
                    Wrap: =false
                    X: =DisplayKeyX
                    Y: =DisplayKeyY
                    ZIndex: =1

                cardProjRole As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =DisplayValueBorderThick
                    Color: =ColorValue(DisplayValueColor)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =DisplayValueFont
                    Height: =DisplayValueH
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =DisplayValueFontSize
                    Tooltip: =Parent.DisplayName
                    Width: =DisplayValueW
                    X: =170
                    ZIndex: =2

                ErrorMessage67 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =cardProjRole.Y + cardProjRole.Height
                    ZIndex: =3

                StarVisible67 As label:
                    Align: =Align.Center
                    Height: =DataCardKey70.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey70.Y
                    ZIndex: =4

            crdStartDate_Main As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="StartDate"
                Default: =ThisItem.StartDate
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Start Date"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =CardH
                MaxLength: =DataSourceInfo(SMA_AT5, DataSourceInfo.MaxLength, "StartDate")
                Required: =false
                Update: =cardStartDate.Text
                Visible: =gblCrdStartDateVis
                Width: =415
                WidthFit: =true
                X: =2
                Y: =1
                ZIndex: =1

                DataCardKey90 As label:
                    AutoHeight: =true
                    Color: =ColorValue(ColorDarkBlue)
                    Font: =DisplayKeyFont
                    Height: =34
                    Size: =DisplayKeyFontSize
                    Text: =Parent.DisplayName
                    Width: =DisplayKeyW
                    Wrap: =false
                    X: =DisplayKeyX
                    Y: =DisplayKeyY
                    ZIndex: =1

                cardStartDate As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =DisplayValueBorderThick
                    Color: =ColorValue(DisplayValueColor)
                    Default: =locSelectedPersonStartDate
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =DisplayValueFont
                    Height: =DisplayValueH
                    MaxLength: =Parent.MaxLength
                    OnSelect: |-
                        =Set(pupDatePicker, true);
                        Set(locSetDate, "START");
                        Set(locGreyOutVis,true);
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =DisplayValueFontSize
                    Tooltip: =Parent.DisplayName
                    Width: =DisplayValueW
                    X: =170
                    ZIndex: =2

                ErrorMessage87 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =cardStartDate.Y + cardStartDate.Height
                    ZIndex: =3

                StarVisible87 As label:
                    Align: =Align.Center
                    Height: =DataCardKey90.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey90.Y
                    ZIndex: =4

            crdEndDateExtension_Main As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="EndDate"
                Default: =ThisItem.EndDate
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="End Date"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =CardH
                MaxLength: =DataSourceInfo(SMA_AT5, DataSourceInfo.MaxLength, "EndDateExtension")
                Required: =false
                Update: =cardEndDateExt.Text
                Visible: =gblCrdEndDateVis
                Width: =415
                WidthFit: =true
                X: =3
                Y: =1
                ZIndex: =1

                DataCardKey29 As label:
                    AutoHeight: =true
                    Color: =ColorValue(ColorDarkBlue)
                    Font: =DisplayKeyFont
                    Height: =DisplayKeyH
                    Size: =DisplayKeyFontSize
                    Text: =Parent.DisplayName
                    Width: =DisplayKeyW
                    Wrap: =false
                    X: =DisplayKeyX
                    Y: =DisplayKeyY
                    ZIndex: =1

                cardEndDateExt As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =DisplayValueBorderThick
                    Color: =ColorValue(DisplayValueColor)
                    Default: =locSelectedPersonEndDate
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =DisplayValueFont
                    MaxLength: =Parent.MaxLength
                    OnSelect: |-
                        =Set(pupDatePicker, true);
                        Set(locSetDate, "END");
                        Set(locGreyOutVis,true);
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =DisplayValueFontSize
                    Tooltip: =Parent.DisplayName
                    Width: =DisplayValueW
                    X: =170
                    ZIndex: =2

                ErrorMessage27 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =cardEndDateExt.Y + cardEndDateExt.Height
                    ZIndex: =3

                StarVisible27 As label:
                    Align: =Align.Center
                    Height: =DataCardKey29.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey29.Y
                    ZIndex: =4

            crdSalaryBand_Main As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="SalaryBand"
                Default: =ThisItem.SalaryBand
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Salary Band"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =CardH
                MaxLength: =DataSourceInfo([@SMA_AT5], DataSourceInfo.MaxLength, "SalaryBand")
                Required: =false
                Update: =cardSalaryBand.Text
                Visible: =gblCrdSalleryBandVis
                Width: =415
                WidthFit: =true
                X: =4
                Y: =1
                ZIndex: =1

                DataCardKey84 As label:
                    Color: =ColorValue(ColorDarkBlue)
                    Font: =DisplayKeyFont
                    Size: =DisplayKeyFontSize
                    Text: |-
                        ="Salary Band 
                        (or Agency Rate)"
                    Width: =205
                    Wrap: =false
                    X: =DisplayKeyX
                    ZIndex: =1

                cardSalaryBand As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =DisplayValueBorderThick
                    Color: =ColorValue(DisplayValueColor)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =DisplayValueFont
                    Height: =DisplayValueH
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =DisplayValueFontSize
                    Tooltip: =Parent.DisplayName
                    Width: =DisplayValueW
                    X: =170
                    ZIndex: =2

                ErrorMessage81 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =cardSalaryBand.Y + cardSalaryBand.Height
                    ZIndex: =3

                StarVisible81 As label:
                    Align: =Align.Center
                    Height: =DataCardKey84.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey84.Y
                    ZIndex: =4

            crdJacobsUsername_Main As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="JacobsUsername"
                Default: =ThisItem.JacobsUsername
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Jacobs Username"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =CardH
                MaxLength: =DataSourceInfo(SMA_AT5, DataSourceInfo.MaxLength, "JacobsUsername")
                Required: =false
                Update: =DataCardValue48.Text
                Visible: =false
                Width: =415
                WidthFit: =true
                X: =0
                Y: =2
                ZIndex: =1

                DataCardKey46 As label:
                    AutoHeight: =true
                    Color: =ColorValue(DisplayKeyColor)
                    Font: =DisplayKeyFont
                    Height: =DisplayKeyH
                    Size: =DisplayKeyFontSize
                    Text: =Parent.DisplayName
                    Width: =DisplayKeyW
                    Wrap: =false
                    X: =DisplayKeyX
                    Y: =DisplayKeyY
                    ZIndex: =1

                DataCardValue48 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =DisplayValueBorderThick
                    Color: =ColorValue(DisplayValueColor)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =DisplayValueFont
                    Height: =DisplayValueH
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =DisplayValueFontSize
                    Tooltip: =Parent.DisplayName
                    Width: =DisplayValueW
                    X: =DisplayValueX
                    Y: =DisplayValueY
                    ZIndex: =2

                ErrorMessage43 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue48.Y + DataCardValue48.Height
                    ZIndex: =3

                StarVisible43 As label:
                    Align: =Align.Center
                    Height: =DataCardKey46.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey46.Y
                    ZIndex: =4

            Discipline_DataCard1 As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="Discipline"
                Default: =ThisItem.Discipline
                DisplayMode: =DisplayMode.View
                DisplayName: =DataSourceInfo([@SMA_AT5],DataSourceInfo.DisplayName,"Discipline")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =CardH
                MaxLength: =DataSourceInfo([@SMA_AT5], DataSourceInfo.MaxLength, "Discipline")
                Required: =false
                Update: =DataCardValue55.Text
                Visible: =gblCrdDiscp
                Width: =419
                X: =1
                Y: =3
                ZIndex: =1

                DataCardKey72 As label:
                    AutoHeight: =true
                    Color: =ColorValue(ColorDarkBlue)
                    Font: =Font.Arial
                    Height: =25
                    Size: =10
                    Text: =Parent.DisplayName
                    Width: =DisplayKeyW
                    Wrap: =false
                    X: =DisplayKeyX
                    Y: =DisplayKeyY
                    ZIndex: =1

                DataCardValue55 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    Color: =ColorValue(DisplayValueColor)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =Font.Arial
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =10
                    Tooltip: =Parent.DisplayName
                    Width: =DisplayValueW
                    X: =170
                    ZIndex: =2

                ErrorMessage54 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue55.Y + DataCardValue55.Height
                    ZIndex: =3

                StarVisible56 As label:
                    Align: =Align.Center
                    Height: =DataCardKey72.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey72.Y
                    ZIndex: =4

            crdComputerID_Main As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="ComputerID"
                Default: =ThisItem.ComputerID
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Computer ID"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =60
                MaxLength: =DataSourceInfo(SMA_AT5, DataSourceInfo.MaxLength, "ComputerID")
                Required: =false
                Update: =DataCardValue4.Text
                Visible: =false
                Width: =415
                X: =0
                Y: =4
                ZIndex: =1

                DataCardKey4 As label:
                    AutoHeight: =true
                    Color: =ColorValue(DisplayKeyColor)
                    Font: =DisplayKeyFont
                    Height: =DisplayKeyH
                    Size: =DisplayKeyFontSize
                    Text: =Parent.DisplayName
                    Width: =DisplayKeyW
                    Wrap: =false
                    X: =DisplayKeyY
                    Y: =DisplayKeyY
                    ZIndex: =1

                DataCardValue4 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =DisplayValueBorderThick
                    Color: =ColorValue(DisplayValueColor)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =DisplayValueFont
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =DisplayValueFontSize
                    Tooltip: =Parent.DisplayName
                    Width: =DisplayValueW
                    X: =DisplayValueX
                    Y: =DisplayValueY
                    ZIndex: =2

                ErrorMessage4 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue4.Y + DataCardValue4.Height
                    ZIndex: =3

                StarVisible4 As label:
                    Align: =Align.Center
                    Height: =DataCardKey4.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey4.Y
                    ZIndex: =4

            crdQualification_Main As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="Qualification"
                Default: =ThisItem.Qualification
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Qualification"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =CardH
                MaxLength: =DataSourceInfo(SMA_AT5, DataSourceInfo.MaxLength, "Qualification")
                Required: =false
                Update: =DataCardValue77.Text
                Visible: =gblCrdQualificationVis
                Width: =415
                WidthFit: =true
                X: =0
                Y: =8
                ZIndex: =1

                DataCardKey75 As label:
                    AutoHeight: =true
                    Color: =ColorValue(DisplayKeyColor)
                    Font: =DisplayKeyFont
                    Height: =DisplayKeyH
                    Size: =DisplayKeyFontSize
                    Text: =Parent.DisplayName
                    Width: =DisplayKeyW
                    Wrap: =false
                    X: =DisplayKeyX
                    Y: =DisplayKeyY
                    ZIndex: =1

                DataCardValue77 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =DisplayValueBorderThick
                    Color: =ColorValue(DisplayValueColor)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =DisplayValueFont
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =DisplayValueFontSize
                    Tooltip: =Parent.DisplayName
                    Width: =DisplayValueW
                    X: =DisplayValueX
                    Y: =DisplayValueY
                    ZIndex: =2

                ErrorMessage72 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue77.Y + DataCardValue77.Height
                    ZIndex: =3

                StarVisible72 As label:
                    Align: =Align.Center
                    Height: =DataCardKey75.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey75.Y
                    ZIndex: =4

            crdPhotoLink_Main As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="PhotoLink"
                Default: =ThisItem.PhotoLink
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Photo Link"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =CardH
                MaxLength: =DataSourceInfo(SMA_AT5, DataSourceInfo.MaxLength, "PhotoLink")
                Required: =false
                Update: =DataCardValue66.Text
                Visible: =gblCrdPhotoLinkVis
                Width: =415
                WidthFit: =true
                X: =0
                Y: =9
                ZIndex: =1

                DataCardKey64 As label:
                    AutoHeight: =true
                    Color: =ColorValue(DisplayKeyColor)
                    Font: =DisplayKeyFont
                    Height: =DisplayKeyH
                    Size: =DisplayKeyFontSize
                    Text: =Parent.DisplayName
                    Width: =DisplayKeyW
                    Wrap: =false
                    X: =DisplayKeyX
                    Y: =DisplayKeyY
                    ZIndex: =1

                DataCardValue66 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =DisplayValueBorderThick
                    Color: =ColorValue(DisplayValueColor)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =DisplayValueFont
                    Height: =DisplayValueH
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =DisplayValueFontSize
                    Tooltip: =Parent.DisplayName
                    Width: =DisplayValueW
                    X: =DisplayValueX
                    Y: =DisplayValueY
                    ZIndex: =2

                ErrorMessage61 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue66.Y + DataCardValue66.Height
                    ZIndex: =3

                StarVisible61 As label:
                    Align: =Align.Center
                    Height: =DataCardKey64.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey64.Y
                    ZIndex: =4

            crdPhoneNumber_Main As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="PhoneNumber"
                Default: =ThisItem.PhoneNumber
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Phone Number"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =CardH
                MaxLength: =DataSourceInfo([@SMA_AT5], DataSourceInfo.MaxLength, "PhoneNumber")
                Required: =false
                Update: =DataCardValue65.Text
                Visible: =gblCrdPhoneNumberVis
                Width: =415
                WidthFit: =true
                X: =0
                Y: =10
                ZIndex: =1

                DataCardKey63 As label:
                    AutoHeight: =true
                    Color: =ColorValue(DisplayKeyColor)
                    Font: =DisplayKeyFont
                    Height: =DisplayKeyH
                    Size: =DisplayKeyFontSize
                    Text: =Parent.DisplayName
                    Width: =DisplayKeyW
                    Wrap: =false
                    X: =DisplayKeyX
                    Y: =DisplayKeyY
                    ZIndex: =1

                DataCardValue65 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =DisplayValueBorderThick
                    Color: =ColorValue(DisplayValueColor)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =DisplayValueFont
                    Height: =DisplayValueH
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =DisplayValueFontSize
                    Tooltip: =Parent.DisplayName
                    Width: =DisplayValueW
                    X: =DisplayValueX
                    Y: =DisplayValueY
                    ZIndex: =2

                ErrorMessage60 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue65.Y + DataCardValue65.Height
                    ZIndex: =3

                StarVisible60 As label:
                    Align: =Align.Center
                    Height: =DataCardKey63.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey63.Y
                    ZIndex: =4

            crdCVLink_Main As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="CVLink"
                Default: =ThisItem.CVLink
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="CV Link"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =CardH
                MaxLength: =DataSourceInfo([@SMA_AT5], DataSourceInfo.MaxLength, "CVLink")
                Required: =false
                Update: =DataCardValue22.Text
                Visible: =gblCrdCVLinkVis
                Width: =415
                WidthFit: =true
                X: =0
                Y: =11
                ZIndex: =1

                DataCardKey20 As label:
                    AutoHeight: =true
                    Color: =ColorValue(DisplayKeyColor)
                    Font: =DisplayKeyFont
                    Height: =DisplayKeyH
                    Size: =DisplayKeyFontSize
                    Text: =Parent.DisplayName
                    Width: =DisplayKeyW
                    Wrap: =false
                    X: =DisplayKeyX
                    Y: =DisplayKeyY
                    ZIndex: =1

                DataCardValue22 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =DisplayValueBorderThick
                    Color: =ColorValue(DisplayValueColor)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =DisplayValueFont
                    Height: =DisplayValueH
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =DisplayValueFontSize
                    Tooltip: =Parent.DisplayName
                    Width: =DisplayValueW
                    X: =DisplayValueX
                    Y: =DisplayValueY
                    ZIndex: =2

                ErrorMessage20 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue22.Y + DataCardValue22.Height
                    ZIndex: =3

                StarVisible20 As label:
                    Align: =Align.Center
                    Height: =DataCardKey20.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey20.Y
                    ZIndex: =4

            crdExpenses_Main As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="Expenses"
                Default: =ThisItem.Expenses
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Expenses"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =CardH
                MaxLength: =DataSourceInfo(SMA_AT5, DataSourceInfo.MaxLength, "Expenses")
                Required: =false
                Update: =cardExpenses.Text
                Visible: =gblCrdExpensesVis
                Width: =415
                WidthFit: =true
                X: =0
                Y: =16
                ZIndex: =1

                DataCardKey32 As label:
                    Color: =ColorValue(ColorDarkBlue)
                    Font: =DisplayKeyFont
                    Height: =27
                    Size: =DisplayKeyFontSize
                    Text: ="Expenses Permitted?"
                    Width: =142
                    Wrap: =false
                    X: =DisplayKeyX
                    Y: =DisplayKeyY
                    ZIndex: =1

                cardExpenses As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =DisplayValueBorderThick
                    Color: =ColorValue(DisplayValueColor)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =DisplayValueFont
                    Height: =DisplayValueH
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =DisplayValueFontSize
                    Tooltip: =Parent.DisplayName
                    Width: =DisplayValueW
                    X: =170
                    ZIndex: =2

                ErrorMessage30 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =cardExpenses.Y + cardExpenses.Height
                    ZIndex: =3

                StarVisible30 As label:
                    Align: =Align.Center
                    Height: =DataCardKey32.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey32.Y
                    ZIndex: =4

            LastEditor_DataCard1 As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="LastEditor"
                Default: =currentUserEmail
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@SMA_AT5],DataSourceInfo.DisplayName,"LastEditor")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                MaxLength: =DataSourceInfo([@SMA_AT5], DataSourceInfo.MaxLength, "LastEditor")
                Required: =false
                Update: =DataCardValue31.Text
                Visible: =false
                Width: =419
                X: =0
                Y: =30
                ZIndex: =1

                DataCardKey40 As label:
                    AutoHeight: =true
                    Height: =34
                    Text: =Parent.DisplayName
                    Width: =(Parent.Width - 60) * 0.4
                    Wrap: =false
                    X: =30
                    Y: =10 + (DataCardValue31.Height / 2) - (Self.Height / 2)
                    ZIndex: =1

                DataCardValue31 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    Default: =User().Email
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =Parent.DisplayName
                    Width: =(Parent.Width - 60) * 0.6
                    X: =DataCardKey40.X + DataCardKey40.Width
                    Y: =10
                    ZIndex: =2

                ErrorMessage22 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue31.Y + DataCardValue31.Height
                    ZIndex: =3

                StarVisible39 As label:
                    Align: =Align.Center
                    Height: =DataCardKey40.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey40.Y
                    ZIndex: =4

            EditComment_DataCard2 As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="EditComment"
                Default: =ThisItem.EditComment
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@SMA_AT5],DataSourceInfo.DisplayName,"EditComment")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                MaxLength: =DataSourceInfo([@SMA_AT5], DataSourceInfo.MaxLength, "EditComment")
                Required: =false
                Update: =DataCardValue50.Text
                Visible: =false
                Width: =419
                X: =0
                Y: =31
                ZIndex: =1

                DataCardKey62 As label:
                    AutoHeight: =true
                    Height: =34
                    Text: =Parent.DisplayName
                    Width: =(Parent.Width - 60) * 0.4
                    Wrap: =false
                    X: =30
                    Y: =10 + (DataCardValue50.Height / 2) - (Self.Height / 2)
                    ZIndex: =1

                DataCardValue50 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    Default: =txtEditComment_PC.Text
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =Parent.DisplayName
                    Width: =(Parent.Width - 60) * 0.6
                    X: =DataCardKey62.X + DataCardKey62.Width
                    Y: =10
                    ZIndex: =2

                ErrorMessage48 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue50.Y + DataCardValue50.Height
                    ZIndex: =3

                StarVisible50 As label:
                    Align: =Align.Center
                    Height: =DataCardKey62.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey62.Y
                    ZIndex: =4

            PWLevel_DataCard1 As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="PWLevel"
                Default: =ThisItem.PWLevel
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@SMA_AT5],DataSourceInfo.DisplayName,"PWLevel")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =CardH
                MaxLength: =DataSourceInfo([@SMA_AT5], DataSourceInfo.MaxLength, "PWLevel")
                Required: =false
                Update: =DataCardValue23.Text
                Visible: =gblCrdPWLevel
                Width: =419
                WidthFit: =false
                X: =0
                Y: =32
                ZIndex: =1

                DataCardKey28 As label:
                    AutoHeight: =true
                    Color: =ColorValue(ColorDarkBlue)
                    Font: =Font.Arial
                    Height: =25
                    Size: =DisplayKeyFontSize
                    Text: |-
                        ="Project Wise Access 
                        Level Required"
                    Width: =140
                    Wrap: =false
                    X: =DisplayKeyX
                    ZIndex: =1

                DataCardValue23 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =0.5
                    Color: =ColorValue(DisplayValueColor)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =Font.Arial
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =10
                    Tooltip: =Parent.DisplayName
                    Width: =DisplayValueW
                    X: =170
                    ZIndex: =2

                ErrorMessage21 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue23.Y + DataCardValue23.Height
                    ZIndex: =3

                StarVisible22 As label:
                    Align: =Align.Center
                    Height: =DataCardKey28.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey28.Y
                    ZIndex: =4

            Prod_FullPartTime_DataCard1 As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="Prod_FullPartTime"
                Default: =ThisItem.Prod_FullPartTime
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@SMA_AT5],DataSourceInfo.DisplayName,"Prod_FullPartTime")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =CardH
                MaxLength: =DataSourceInfo([@SMA_AT5], DataSourceInfo.MaxLength, "Prod_FullPartTime")
                Required: =false
                Update: =DataCardValue56.Text
                Visible: =If(gblUserGroupId_A <> 9 , true, false)
                Width: =419
                X: =0
                Y: =33
                ZIndex: =1

                DataCardKey31 As label:
                    Color: =ColorValue(ColorDarkBlue)
                    Font: =Font.Arial
                    Size: =10
                    Text: |-
                        ="Expectation of 
                        normal hours"
                    Width: =181
                    Wrap: =false
                    X: =DisplayKeyX
                    ZIndex: =1

                DataCardValue56 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =0.5
                    Color: =ColorValue(DisplayValueColor)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =Font.Arial
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =DisplayValueFontSize
                    Tooltip: =Parent.DisplayName
                    Width: =DisplayValueW
                    X: =170
                    ZIndex: =2

                ErrorMessage66 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue56.Y + DataCardValue56.Height
                    ZIndex: =3

                StarVisible68 As label:
                    Align: =Align.Center
                    Height: =DataCardKey31.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey31.Y
                    ZIndex: =4

            crdRequester_Main As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="Requester"
                Default: =ThisItem.Requester
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Requester"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =CardH
                MaxLength: =DataSourceInfo(SMA_AT5, DataSourceInfo.MaxLength, "Requester")
                Required: =false
                Update: =DataCardValue84.Text
                Visible: =true
                Width: =408
                WidthFit: =true
                X: =1
                Y: =33
                ZIndex: =1

                DataCardKey82 As label:
                    AutoHeight: =true
                    Color: =ColorValue(ColorDarkBlue)
                    Font: =DisplayKeyFont
                    Height: =DisplayKeyH
                    Size: =DisplayKeyFontSize
                    Text: ="Requestor's email"
                    Width: =DisplayKeyW
                    Wrap: =false
                    X: =DisplayKeyX
                    Y: =DisplayKeyY
                    ZIndex: =1

                DataCardValue84 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =DisplayValueBorderThick
                    Color: =ColorValue(DisplayValueColor)
                    Default: |-
                        =locRequestorToDisplay
                        /*If( ThisItem.Title in Parent.Default, 
                        
                            // "PAFTitle - PAF/RequestorEmail"  -> "email"
                                Substitute(Parent.Default, ThisItem.Title, ""),
                            
                            // "RequestorTitle PAFEmail"  -> "RequestorTitle"
                            If(ThisItem.Email in Parent.Default && !(ThisItem.Title in Parent.Default),
                                Substitute(Parent.Default, ThisItem.Email, ""),
                        
                            // "RequestorTitle
                            If("-" in Parent.Default,
                                Parent.Default,
                        
                            // Requestor == "RequestorTitleRequestorEmail" -> "email"     
                            If( Lower(Replace(Substitute(Substitute(First(ForAll(Split(ThisItem.Requester,"@"), {Result: ThisRecord.Value})).Result,".", "")," ",""),1,Len(Substitute(Substitute(First(ForAll(Split(ThisItem.Requester,"@"), {Result: ThisRecord.Value})).Result,".", "")," ",""))/2,         ""))= Lower(Replace(Substitute(Substitute(First(ForAll(Split(ThisItem.Requester,"@"), {Result: ThisRecord.Value})).Result,".", "")," ",""),Len(Substitute(Substitute(First(ForAll(Split(ThisItem.Requester,"@"), {Result: ThisRecord.Value})).Result,".", "")," ",""))        /2+1,Len(Substitute(Substitute(First(ForAll(Split(ThisItem.Requester,"@"), {Result: ThisRecord.Value})).Result,".", "")," ","")),"")),  
                                        
                                Replace(ThisItem.Requester, 1, Len(Substitute(First(ForAll(Split(ThisItem.Requester,"@"), {Result: ThisRecord.Value})).Result,".", ""))/2+1, ""),
                                
                                Parent.Default)
                        )))*/
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =DisplayValueFont
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =DisplayValueFontSize
                    Tooltip: =Parent.DisplayName
                    Width: =DisplayValueW
                    X: =170
                    ZIndex: =2

                ErrorMessage79 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue84.Y + DataCardValue84.Height
                    ZIndex: =3

                StarVisible79 As label:
                    Align: =Align.Center
                    Height: =DataCardKey82.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey82.Y
                    ZIndex: =4

            DemobilisationDate_DataCard1 As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="DemobilisationDate"
                Default: =ThisItem.DemobilisationDate
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@SMA_AT5],DataSourceInfo.DisplayName,"DemobilisationDate")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =CardH
                MaxLength: =DataSourceInfo([@SMA_AT5], DataSourceInfo.MaxLength, "DemobilisationDate")
                Required: =false
                Update: =DataCardValue71.Text
                Visible: =If(gblUserGroupId_A=8||gblUserGroupId_A=9, true, false)
                Width: =419
                X: =2
                Y: =33
                ZIndex: =1

                DataCardKey81 As label:
                    AutoHeight: =true
                    Color: =ColorValue(ColorDarkBlue)
                    Font: =DisplayKeyFont
                    Height: =25
                    Size: =10
                    Text: ="Demobilisation Date"
                    Width: =145
                    Wrap: =false
                    X: =DisplayKeyX
                    Y: =DisplayKeyY
                    ZIndex: =1

                DataCardValue71 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =0.5
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =Font.Arial
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =10
                    Tooltip: =Parent.DisplayName
                    Width: =DisplayValueW
                    X: =170
                    Y: =1
                    ZIndex: =2

                ErrorMessage64 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue71.Y + DataCardValue71.Height
                    ZIndex: =3

                StarVisible71 As label:
                    Align: =Align.Center
                    Height: =DataCardKey81.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey81.Y
                    ZIndex: =4

            Rate_DataCard1 As typedDataCard.numberEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="Rate"
                Default: =ThisItem.Rate
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@SMA_AT5],DataSourceInfo.DisplayName,"Rate")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =CardH
                Required: =false
                Update: =Value(DataCardValue72.Text)
                Visible: =If(gblUserGroupId_A=8||gblUserGroupId_A=9, true, false)
                Width: =419
                X: =3
                Y: =33
                ZIndex: =1

                DataCardKey83 As label:
                    AutoHeight: =true
                    Color: =ColorValue(ColorDarkBlue)
                    Font: =DisplayKeyFont
                    Height: =DisplayKeyH
                    Size: =10
                    Text: =Parent.DisplayName
                    Width: =DisplayKeyW
                    Wrap: =false
                    X: =DisplayKeyX
                    Y: =DisplayKeyY
                    ZIndex: =1

                DataCardValue72 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =0.5
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =Font.Arial
                    Format: =TextFormat.Number
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =10
                    Tooltip: =Parent.DisplayName
                    Width: =DisplayValueW
                    X: =170
                    Y: =1
                    ZIndex: =2

                ErrorMessage68 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue72.Y + DataCardValue72.Height
                    ZIndex: =3

                StarVisible73 As label:
                    Align: =Align.Center
                    Height: =DataCardKey83.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey83.Y
                    ZIndex: =4

            SMPAEmail_DataCard1 As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="SMPAEmail"
                Default: =ThisItem.SMPAEmail
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@SMA_AT5],DataSourceInfo.DisplayName,"SMPAEmail")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =CardH
                MaxLength: =DataSourceInfo([@SMA_AT5], DataSourceInfo.MaxLength, "SMPAEmail")
                Required: =false
                Update: =DataCardValue73.Text
                Visible: |-
                    =//If(gblUserGroupId_A=8||gblUserGroupId_A=9, true, false)
                    false
                Width: =419
                X: =4
                Y: =33
                ZIndex: =1

                DataCardKey85 As label:
                    AutoHeight: =true
                    Color: =ColorValue(ColorDarkBlue)
                    Font: =DisplayKeyFont
                    Height: =DisplayKeyH
                    Size: =10
                    Text: ="SMPA Email"
                    Width: =DisplayKeyW
                    Wrap: =false
                    X: =DisplayKeyX
                    Y: =DisplayKeyY
                    ZIndex: =1

                DataCardValue73 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =0.5
                    Color: =ColorValue(DisplayValueColor)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =Font.Arial
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =10
                    Tooltip: =Parent.DisplayName
                    Width: =DisplayValueW
                    X: =170
                    Y: =1
                    ZIndex: =2

                ErrorMessage69 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue73.Y + DataCardValue73.Height
                    ZIndex: =3

                StarVisible74 As label:
                    Align: =Align.Center
                    Height: =DataCardKey85.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey85.Y
                    ZIndex: =4

            Level_Calc_DataCard2 As typedDataCard.numberEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="Level_Calc"
                Default: =ThisItem.Level_Calc
                DisplayMode: =DisplayMode.View
                DisplayName: =DataSourceInfo([@SMA_AT5],DataSourceInfo.DisplayName,"Level_Calc")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =CardH
                Required: =true
                Update: =Value(DataCardValue74.Text)
                Visible: =If(gblUserGroupId_A=8||gblUserGroupId_A=9, true, false)
                Width: =419
                X: =5
                Y: =33
                ZIndex: =1

                DataCardKey87 As label:
                    AutoHeight: =true
                    Color: =ColorValue(ColorDarkBlue)
                    Font: =Font.Arial
                    Height: =DisplayKeyH
                    Size: =10
                    Text: ="Approval Level"
                    Width: =DisplayKeyW
                    Wrap: =false
                    X: =DisplayKeyX
                    Y: =DisplayKeyY
                    ZIndex: =1

                DataCardValue74 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =0.5
                    Color: =ColorValue(DisplayValueColor)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =Font.Arial
                    Format: =TextFormat.Number
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =10
                    Tooltip: =Parent.DisplayName
                    Width: =DisplayValueW
                    X: =170
                    Y: =1
                    ZIndex: =2

                ErrorMessage70 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue74.Y + DataCardValue74.Height
                    ZIndex: =3

                StarVisible75 As label:
                    Align: =Align.Center
                    Height: =DataCardKey87.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey87.Y
                    ZIndex: =4

            AccessGroup_DataCard1 As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="AccessGroup"
                Default: =ThisItem.AccessGroup
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@SMA_AT5],DataSourceInfo.DisplayName,"AccessGroup")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =CardH
                MaxLength: =DataSourceInfo([@SMA_AT5], DataSourceInfo.MaxLength, "AccessGroup")
                Required: =false
                Update: =DataCardValue75.Text
                Visible: =If(gblUserGroupId_A=8||gblUserGroupId_A=9, true, false)
                Width: =419
                X: =6
                Y: =33
                ZIndex: =1

                DataCardKey88 As label:
                    AutoHeight: =true
                    Color: =ColorValue(ColorDarkBlue)
                    Font: =Font.Arial
                    Height: =DisplayKeyH
                    Size: =10
                    Text: =Parent.DisplayName
                    Width: =DisplayKeyW
                    Wrap: =false
                    X: =DisplayKeyX
                    Y: =DisplayKeyY
                    ZIndex: =1

                DataCardValue75 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =0.5
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Font: =Font.Arial
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =10
                    Tooltip: =Parent.DisplayName
                    Width: =DisplayValueW
                    X: =170
                    Y: =1
                    ZIndex: =2

                ErrorMessage71 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue75.Y + DataCardValue75.Height
                    ZIndex: =3

                StarVisible76 As label:
                    Align: =Align.Center
                    Height: =DataCardKey88.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey88.Y
                    ZIndex: =4

        btnDetailsform As button:
            BorderColor: =ColorFade(ColorValue(ColorDarkBlue), -15%)
            BorderThickness: =0.5
            DisplayMode: =If(IsBlank(SelectedPerson_Name), DisplayMode.Disabled, DisplayMode.Edit)
            Fill: =ColorValue(ColorLightBlue)
            Font: =Font.Arial
            Height: =35
            HoverFill: =ColorValue(ColorGray)
            OnSelect: |-
                =If(DetailsFormMode = FormMode.View,
                    Set(DetailsFormMode, FormMode.Edit),
                    Set(DetailsFormEdit_PopUpVis, true)) 
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Text: =If(DetailsFormMode = FormMode.View, "Edit", "Stop Editing")
            Visible: =If(IsBlank(SelectedPerson_Name) And gblUserGroupId_A <> 7 Or SelectedPerson_Name = "" And gblUserGroupId_A <> 7, false, true)
            Width: =417
            X: =587
            Y: =732
            ZIndex: =27

        lblApprovalTop_1 As label:
            Align: =Align.Center
            Color: =ColorValue(ColorWhite)
            Fill: =ColorValue(ColorLightBlue)
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            Height: =51
            Text: =SelectedPerson_Name
            Width: =419
            X: =585
            Y: =50
            ZIndex: =33

    btnCsvExport As button:
        BorderColor: =ColorValue(ColorWhite)
        BorderThickness: =1
        Color: =ColorValue(ColorWhite)
        Fill: =RGBA(0, 0, 0, 0)
        Font: =Font.Lato
        FontWeight: =FontWeight.Lighter
        Height: =36
        HoverColor: =ColorValue(ColorGray)
        HoverFill: =
        OnSelect: |-
            =// Open CSV export popup
            ClearCollect(colAllPeople, If("All" in gblUserProjects, 
                                            colPeopleForApproval,
                                            Filter(colPeopleForApproval, Project in gblUserProjects)));
            ClearCollect(colPeopleToExport, AddColumns(colAllPeople, "ChoosenToExport", false));
            Set(locPupCsvVisibility, true);
            Set(locGreyOutVis, true);
            Set(locLinkToCSV, "empty");
            
            Set(locMassiveApproval, false); Reset(toggleMassiveApproval);
            UpdateContext({EmailSentInfo:false});
        PaddingBottom: =1
        PaddingLeft: =1
        PaddingRight: =1
        PaddingTop: =1
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =10
        Text: ="Export records to CSV"
        Visible: =If(gblUserGroupId_A <> 7 Or SelectedPerson_Name = "" And gblUserGroupId_A <> 7, false, true)
        Width: =225
        Y: =732
        ZIndex: =37

    shpGreyOut As rectangle:
        Fill: =RGBA( 248, 248, 255, 0.5)
        Height: =768
        Visible: =locGreyOutVis
        Width: =1366
        ZIndex: =39

    pupDetailsEdit As groupContainer.manualLayoutContainer:
        BorderThickness: =1
        Fill: =RGBA(255, 255, 255, 1)
        Visible: =DetailsFormEdit_PopUpVis
        X: =457
        Y: =302
        ZIndex: =44

        lblEditPup As label:
            Align: =Align.Center
            Font: =Font.Arial
            Height: =38
            Text: ="Do you want to apply changes?"
            Width: =265
            X: =118
            Y: =6
            ZIndex: =1

        btnApplyEdit As button:
            BorderThickness: =1
            DisplayMode: |-
                =If(!IsBlank(txtEditComment_PC),
                    DisplayMode.Edit,
                    DisplayMode.Disabled)
            Fill: =ColorValue(ColorLightBlue)
            Font: =Font.Arial
            Height: =31
            HoverFill: =ColorValue(ColorGray)
            OnSelect: |-
                =Set(locLblSubmitingTxt, "Submiting edits...");
                Set(locLblSubmiting, true);
                
                //If PA or PW edit personal data then level calc = 2   <- REPLACED WITH VERSION BELOW
                //If(gblUserGroupId_A = 9 || gblUserGroupId_A = 8,
                //    Set(locRequestorLevel, 2));
                
                // If Name, EndDate or Salary Band has been changed, PAF requires re-approval
                If(gblUserGroupId_A = 9 || gblUserGroupId_A = 8,
                    If( (IsBlank(locRequestorSalaryBand)=IsBlank(cardSalaryBand.Text) || locRequestorSalaryBand=cardSalaryBand.Text) && locRequestorEndDate=locSelectedPersonEndDate, 
                        Set(locRequestorLevel, 4),
                        Set(locRequestorLevel, 2)));
                
                // Do not change requestor format
                Set(locRequestorToDisplay, locSelectedPersonRequestor);
                
                // Submit form
                SubmitForm(frmDetails);
                
                Set(locLblSubmitingTxt, "Updating list view...");
                /*ClearCollect(colPeopleForApproval, If(
                    gblUserGroupId_A = 1, Filter(SMA_AT5, PM_DIM_Approved = Blank()),
                    gblUserGroupId_A = 2, Filter(SMA_AT5, LeadershipApproved = Blank()),
                    gblUserGroupId_A = 3, Filter(SMA_AT5, HEIPM_Approval = Blank()),
                    gblUserGroupId_A = 4, Filter(SMA_AT5, CommercialSignoff = Blank()),
                    gblUserGroupId_A = 7, Filter(SMA_AT5, ControlSignoff = Blank()),
                    gblUserGroupId_A = 8, Filter(SMA_AT5, PWAdded = Blank()),
                    gblUserGroupId_A = 9, Filter(SMA_AT5, FinalApproval = Blank())
                ));*/
                
                
                Set(locLblSubmiting, false);
                
                Set(DetailsFormEdit_PopUpVis, false);
                Set(DetailsFormMode, FormMode.View);
                Set(SelectedPerson_Name, "");
                Reset(txtEditComment_PC);
                
                //Create Main Collection - Part 1/2 - For the specified Level_Calc and HomeOrganisation filters
                Switch(
                    gblUserGroupId_A,
                    //PM Workstream lead
                    1, If(
                        First(gblUserHomeOrg.Result).Result = "All",
                        ClearCollect(colNewStartersPM_HomeOrg, Filter(SMA_AT5, Level_Calc=1)),
                        ClearCollect(colNewStartersPM_HomeOrg, Filter(SMA_AT5, Level_Calc=1, HomeOrganisation=First(gblUserHomeOrg.Result).Result))
                    ),
                    //Director Manager
                    2, If(
                        First(gblUserHomeOrg.Result).Result = "All",
                        ClearCollect(colNewStartersPM_HomeOrg, Filter(SMA_AT5, Level_Calc=2)),
                        ClearCollect(colNewStartersPM_HomeOrg, Filter(SMA_AT5, Level_Calc=2, HomeOrganisation=First(gblUserHomeOrg.Result).Result))
                    ),
                    //Project Controls
                    7, If(
                        First(gblUserHomeOrg.Result).Result = "All",
                        ClearCollect(colPeopleForApproval_HomeOrg, Filter(SMA_AT5, ControlSignoff = Blank() Or ControlSignoff = "" Or ControlSignoff = "No", Level_Calc=0)),
                        ClearCollect(colPeopleForApproval_HomeOrg, Filter(SMA_AT5, ControlSignoff = Blank() Or ControlSignoff = "" Or ControlSignoff = "No", Level_Calc=0, HomeOrganisation=First(gblUserHomeOrg.Result).Result))
                    ),
                    //Project Accountant
                    8, If(
                        First(gblUserHomeOrg.Result).Result = "All",
                        ClearCollect(colPeopleForApproval_HomeOrg, Filter(SMA_AT5, AccountantSignoff = Blank() Or AccountantSignoff = "" Or AccountantSignoff = "No", Level_Calc=4)),
                        ClearCollect(colPeopleForApproval_HomeOrg, Filter(SMA_AT5, AccountantSignoff = Blank() Or AccountantSignoff = "" Or AccountantSignoff = "No", Level_Calc=4, HomeOrganisation=First(gblUserHomeOrg.Result).Result))
                    ),
                    //Project Wise
                    9, If(
                        First(gblUserHomeOrg.Result).Result = "All",
                        ClearCollect(colPeopleForApproval_HomeOrg, Filter(SMA_AT5, PWAdded = Blank() Or PWAdded = "" Or PWAdded = "No", Level_Calc=4)),
                        ClearCollect(colPeopleForApproval_HomeOrg, Filter(SMA_AT5, PWAdded = Blank() Or PWAdded = "" Or PWAdded = "No", Level_Calc=4, HomeOrganisation=First(gblUserHomeOrg.Result).Result))
                    )
                );
                //Create Main Collection - Part 2/2 - For the specified Level_Calc and Project filters
                Switch(
                    gblUserGroupId_A,
                    //PM Workstream lead
                    1, If(
                        "All" in gblUserProjects,
                        ClearCollect(colNewStartersPM, Filter(colNewStartersPM_HomeOrg, Level_Calc=1)),
                        ClearCollect(colNewStartersPM, Filter(colNewStartersPM_HomeOrg, Level_Calc=1, Project in gblUserProjects))
                    ),
                    //Director Manager
                    2, If(
                        "All" in gblUserProjects,
                        ClearCollect(colNewStartersPM, Filter(colNewStartersPM_HomeOrg, Level_Calc=2)),
                        ClearCollect(colNewStartersPM, Filter(colNewStartersPM_HomeOrg, Level_Calc=2, Project in gblUserProjects))
                    ),
                    //Project Controls
                    7, If(
                        "All" in gblUserProjects,
                        ClearCollect(colPeopleForApproval, Filter(colPeopleForApproval_HomeOrg, ControlSignoff = Blank() Or ControlSignoff = "" Or ControlSignoff = "No", Level_Calc=0)),
                        ClearCollect(colPeopleForApproval, Filter(colPeopleForApproval_HomeOrg, ControlSignoff = Blank() Or ControlSignoff = "" Or ControlSignoff = "No", Level_Calc=0, Project in gblUserProjects))
                    ),
                    //Project Accountant
                    8, If(
                        "All" in gblUserProjects,
                        ClearCollect(colPeopleForApproval, Filter(colPeopleForApproval_HomeOrg, AccountantSignoff = Blank() Or AccountantSignoff = "" Or AccountantSignoff = "No", Level_Calc=4)),
                        ClearCollect(colPeopleForApproval, Filter(colPeopleForApproval_HomeOrg, AccountantSignoff = Blank() Or AccountantSignoff = "" Or AccountantSignoff = "No", Level_Calc=4, Project in gblUserProjects))
                    ),
                    //Project Wise
                    9, If(
                        "All" in gblUserProjects,
                        ClearCollect(colPeopleForApproval, Filter(colPeopleForApproval_HomeOrg, PWAdded = Blank() Or PWAdded = "" Or PWAdded = "No", Level_Calc=4)),
                        ClearCollect(colPeopleForApproval, Filter(colPeopleForApproval_HomeOrg, PWAdded = Blank() Or PWAdded = "" Or PWAdded = "No", Level_Calc=4, Project in gblUserProjects))
                    )
                );
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =12
            Text: ="Apply changes"
            X: =284
            Y: =145
            ZIndex: =2

        btnRejectEdit As button:
            BorderColor: =ColorValue(ColorRed)
            Color: =ColorValue(ColorRed)
            Fill: =ColorValue(ColorWhite)
            Font: =Font.Lato
            Height: =31
            HoverColor: =ColorValue(ColorWhite)
            HoverFill: =ColorValue(ColorRed)
            OnSelect: |-
                =Set(DetailsFormEdit_PopUpVis, false);
                Set(DetailsFormMode, FormMode.View);
                Reset(txtEditComment_PC)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =12
            Text: ="Cancel"
            X: =57
            Y: =145
            ZIndex: =3

        lblSubmitingEdits As label:
            Align: =Align.Center
            Font: =Font.Arial
            Height: =38
            Text: =locLblSubmitingTxt
            Visible: =locLblSubmiting
            Width: =265
            X: =118
            Y: =44
            ZIndex: =4

        txtEditComment_PC As text:
            Default: =""
            Height: =43
            HintText: ="Required Edit Comment"
            Width: =385
            X: =59
            Y: =82
            ZIndex: =5

    pupApproval As groupContainer.manualLayoutContainer:
        BorderColor: =ColorValue(ColorDarkBlue)
        BorderThickness: =1.5
        Fill: =RGBA(255, 255, 255, 1)
        Height: =344
        Visible: =ApprovalPop_UpVis
        Width: =839
        X: =264
        Y: =216
        ZIndex: =45

        lblApprovalPup1 As label:
            Align: =Align.Center
            Font: =Font.Arial
            Height: =42
            Text: |-
                =If(locMassiveApproval,
                    "I am approving selected people request as a: " & gblUserGroup_A, 
                    "I am approving " & SelectedPerson_Name & " request as a: " & gblUserGroup_A
                )
            Width: =431
            X: =195
            Y: =51
            ZIndex: =1

        btnRejectApproval As button:
            BorderColor: =ColorValue(ColorRed)
            Color: =ColorValue(ColorRed)
            Fill: =ColorValue(ColorWhite)
            Font: =Font.Lato
            Height: =31
            HoverColor: =ColorValue(ColorWhite)
            HoverFill: =ColorValue(ColorRed)
            OnSelect: |-
                =Set(ApprovalPop_UpVis, false);
                Set(locGreyOutVis, false);
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =12
            Text: ="Cancel"
            Width: =144
            X: =145
            Y: =263
            ZIndex: =2

        btnApplyEdit_1 As button:
            BorderThickness: =1
            Fill: =ColorValue(ColorLightBlue)
            Font: =Font.Arial
            Height: =31
            HoverFill: =ColorValue(ColorGray)
            OnSelect: |-
                =// show processing label
                Set(locLblProcessingVis, true);
                
                // Do not change requestor format
                If(!locMassiveApproval,
                Set(locRequestorToDisplay, locSelectedPersonRequestor));
                
                // send a request to database
                If(locMassiveApproval,
                    //***MASSIVE APPROVAL***
                    If(
                        //PA
                        gblUserGroupId_A = 8, ForAll(
                            galMassiveApproval.AllItems,
                            Patch(
                                SMA_AT5,
                                {ID2: ThisRecord.ID2},
                                {AccountantSignoff: DataCardValue14_2.Text},
                                {LastEditor: currentUserEmail}
                                
                            )
                        ),
                        //PC
                        gblUserGroupId_A = 7, ForAll(
                            galMassiveApproval.AllItems,
                            Patch(
                                SMA_AT5,
                                {ID2: ThisRecord.ID2},
                                {Level_Calc: 1},
                                {ControlSignoff: DataCardValue14_3.Text},
                                {ControlComments: DataCardValue1.Text},
                                {LastEditor: currentUserEmail}
                            )
                        ),
                        //PW
                        gblUserGroupId_A = 9, ForAll(
                            galMassiveApproval.AllItems,
                            Patch(
                                SMA_AT5,
                                {ID2: ThisRecord.ID2},
                                {PWAdded: DataCardValue14_4.Text},
                                {PWLevel: drpPWlevel.SelectedText.Value},
                                {LastEditor: currentUserEmail}
                            )
                        )       
                    ),
                    //***STANDARD APPROVAL***
                    If(
                        gblUserGroupId_A = 8, SubmitForm(frmCommercial),
                        gblUserGroupId_A = 7, SubmitForm(frmControl),
                        gblUserGroupId_A = 9, SubmitForm(frmPWAdded)
                    )
                );
                
                Set(ApprovalPop_UpVis, false);
                Set(locLblProcessingVis, false);
                Set(SelectedPerson_Name, "");
                Set(locGreyOutVis, false);
                
                // Clear list to massive approval
                Clear(colMassiveApproval);
                
                // Send email 
                If(
                    (gblUserGroupId_A = 8 && !IsBlank(locRequestorEmail)), flwPAemail.Run(locRequestorEmail, locRequestorProject),
                    (gblUserGroupId_A = 9 && !IsBlank(locRequestorEmail)), flwPWemail_01.Run(locRequestorEmail) 
                ); 
                
                
                //Create Main Collection - Part 1/2 - For the specified Level_Calc and HomeOrganisation filters
                Switch(
                    gblUserGroupId_A,
                    //PM Workstream lead
                    1, If(
                        First(gblUserHomeOrg.Result).Result = "All",
                        ClearCollect(colNewStartersPM_HomeOrg, Filter(SMA_AT5, Level_Calc=2)),
                        ClearCollect(colNewStartersPM_HomeOrg, Filter(SMA_AT5, Level_Calc=2, HomeOrganisation=First(gblUserHomeOrg.Result).Result))
                    ),
                    //Director Manager
                    2, If(
                        First(gblUserHomeOrg.Result).Result = "All",
                        ClearCollect(colNewStartersDM_HomeOrg, Filter(SMA_AT5, Level_Calc=3)),
                        ClearCollect(colNewStartersDM_HomeOrg, Filter(SMA_AT5, Level_Calc=3, HomeOrganisation=First(gblUserHomeOrg.Result).Result))
                    ),
                    //National Highways
                    3, ClearCollect(colNewStartersNH, Filter(SMA_AT5, Level_Calc=1)),
                
                    //Project Controls
                    7, If(
                        First(gblUserHomeOrg.Result).Result = "All",
                        ClearCollect(colPeopleForApproval_HomeOrg, Filter(SMA_AT5, ControlSignoff = Blank() Or ControlSignoff = "" Or ControlSignoff = "No", Level_Calc=0)),
                        ClearCollect(colPeopleForApproval_HomeOrg, Filter(SMA_AT5, ControlSignoff = Blank() Or ControlSignoff = "" Or ControlSignoff = "No", Level_Calc=0, HomeOrganisation=First(gblUserHomeOrg.Result).Result))
                    ),
                    //Project Accountant
                    8, If(
                        First(gblUserHomeOrg.Result).Result = "All",
                        ClearCollect(colPeopleForApproval_HomeOrg, Filter(SMA_AT5, AccountantSignoff = Blank() Or AccountantSignoff = "" Or AccountantSignoff = "No", Level_Calc=4)),
                        ClearCollect(colPeopleForApproval_HomeOrg, Filter(SMA_AT5, AccountantSignoff = Blank() Or AccountantSignoff = "" Or AccountantSignoff = "No", Level_Calc=4, HomeOrganisation=First(gblUserHomeOrg.Result).Result))
                    ),
                    //Project Wise
                    9, If(
                        First(gblUserHomeOrg.Result).Result = "All",
                        ClearCollect(colPeopleForApproval_HomeOrg, Filter(SMA_AT5, PWAdded = Blank() Or PWAdded = "" Or PWAdded = "No", Level_Calc=4)),
                        ClearCollect(colPeopleForApproval_HomeOrg, Filter(SMA_AT5, PWAdded = Blank() Or PWAdded = "" Or PWAdded = "No", Level_Calc=4, HomeOrganisation=First(gblUserHomeOrg.Result).Result))
                    )
                );
                //Create Main Collection - Part 2/2 - For the specified Level_Calc and Project filters
                Switch(
                    gblUserGroupId_A,
                    //PM Workstream lead
                    1, If(
                        "All" in gblUserProjects,
                        ClearCollect(colNewStartersPM, Filter(colNewStartersPM_HomeOrg, Level_Calc=2)),
                        "Production Hub" in gblUserProjects,
                        ClearCollect(colNewStartersPM, Filter(colNewStartersPM_HomeOrg, Level_Calc=2, Project in gblUserProjects, Discipline in gblUserDis)),
                        ClearCollect(colNewStartersPM, Filter(colNewStartersPM_HomeOrg, Level_Calc=2, Project in gblUserProjects))
                    ),
                    //Director Manager
                    2, If(
                        "All" in gblUserProjects,
                        ClearCollect(colNewStartersDM, Filter(colNewStartersDM_HomeOrg, Level_Calc=3)),
                        "Production Hub" in gblUserProjects,
                        ClearCollect(colNewStartersDM, Filter(colNewStartersDM_HomeOrg, Level_Calc=3, Project in gblUserProjects, Discipline in gblUserDis)),
                        ClearCollect(colNewStartersDM, Filter(colNewStartersDM_HomeOrg, Level_Calc=3, Project in gblUserProjects))
                    ),
                    //National Highways
                    3,  ClearCollect(colNewStartersNH, Filter(SMA_AT5, Level_Calc=1)),
                    
                    //Project Controls
                    7, If(
                        "All" in gblUserProjects,
                        ClearCollect(colPeopleForApproval, Filter(colPeopleForApproval_HomeOrg, ControlSignoff = Blank() Or ControlSignoff = "" Or ControlSignoff = "No", Level_Calc=0)),
                        "Production Hub" in gblUserProjects,
                        ClearCollect(colPeopleForApproval, Filter(colPeopleForApproval_HomeOrg, ControlSignoff = Blank() Or ControlSignoff = "" Or ControlSignoff = "No", Level_Calc=0, Project in gblUserProjects, Discipline in gblUserDis)),
                        ClearCollect(colPeopleForApproval, Filter(colPeopleForApproval_HomeOrg, ControlSignoff = Blank() Or ControlSignoff = "" Or ControlSignoff = "No", Level_Calc=0, Project in gblUserProjects))
                    ),
                    //Project Accountant
                    8, If(
                        "All" in gblUserProjects,
                        ClearCollect(colPeopleForApproval, Filter(colPeopleForApproval_HomeOrg, AccountantSignoff = Blank() Or AccountantSignoff = "" Or AccountantSignoff = "No", Level_Calc=4)),
                        "Production Hub" in gblUserProjects,
                        ClearCollect(colPeopleForApproval, Filter(colPeopleForApproval_HomeOrg, AccountantSignoff = Blank() Or AccountantSignoff = "" Or AccountantSignoff = "No", Level_Calc=4, Project in gblUserProjects, Discipline in gblUserDis)),
                        ClearCollect(colPeopleForApproval, Filter(colPeopleForApproval_HomeOrg, AccountantSignoff = Blank() Or AccountantSignoff = "" Or AccountantSignoff = "No", Level_Calc=4, Project in gblUserProjects))
                    ),
                    //Project Wise
                    9, If(
                        "All" in gblUserProjects,
                        ClearCollect(colPeopleForApproval, Filter(colPeopleForApproval_HomeOrg, PWAdded = Blank() Or PWAdded = "" Or PWAdded = "No", Level_Calc=4)),
                        "Production Hub" in gblUserProjects,
                        ClearCollect(colPeopleForApproval, Filter(colPeopleForApproval_HomeOrg, PWAdded = Blank() Or PWAdded = "" Or PWAdded = "No", Level_Calc=4, Project in gblUserProjects, Discipline in gblUserDis)),
                        ClearCollect(colPeopleForApproval, Filter(colPeopleForApproval_HomeOrg, PWAdded = Blank() Or PWAdded = "" Or PWAdded = "No", Level_Calc=4, Project in gblUserProjects))
                    ));
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =12
            Text: ="Apply changes"
            X: =534
            Y: =263
            ZIndex: =3

        lblApprovalPup2_1 As label:
            Font: =Font.Arial
            Height: =31
            Text: ="Sending request to database..."
            Visible: =locLblProcessingVis
            Width: =450
            X: =75
            Y: =115
            ZIndex: =4

        frmCommercial As form:
            AcceptsFocus: =false
            DataSource: =SMA_AT5
            Height: =106
            Item: =LookUp(SMA_AT5, ID2=SelectedPerson_ID)
            Visible: =gblCrdCommercialSignoff
            Width: =765
            X: =28
            Y: =123
            ZIndex: =5

            PM_DIM_Approved_DataCard1_2 As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="AccountantSignoff"
                Default: =ThisItem.AccountantSignoff
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="AccountantSignoff"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                MaxLength: =DataSourceInfo(SMA_AT5, DataSourceInfo.MaxLength, "AccountantSignoff")
                Required: =false
                Update: =DataCardValue14_2.Text
                Width: =765
                X: =0
                Y: =0
                ZIndex: =1

                DataCardKey14_2 As label:
                    AutoHeight: =true
                    Color: =ApprovalKeyFontColor
                    Font: =Font.Arial
                    Height: =31
                    Text: ="Project Accountant Signoff"
                    Width: =240
                    Wrap: =false
                    X: =266
                    ZIndex: =1

                DataCardValue14_2 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    Default: =locApprovalText
                    DelayOutput: =true
                    DisplayMode: =DisplayMode.Disabled
                    Height: =36
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =Parent.DisplayName
                    Width: =757
                    X: =8
                    Y: =41
                    ZIndex: =2

            ID2_DataCard5 As typedDataCard.numberEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="ID2"
                Default: =ThisItem.ID2
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="ID2"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                Required: =true
                Update: =Value(DataCardValue30.Text)
                Visible: =false
                Width: =255
                X: =0
                Y: =1
                ZIndex: =1

                DataCardKey39 As label:
                    AutoHeight: =true
                    Height: =34
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue30 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Format: =TextFormat.Number
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey39.Y + DataCardKey39.Height + 5
                    ZIndex: =2

                ErrorMessage16 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue30.Y + DataCardValue30.Height
                    ZIndex: =3

                StarVisible16 As label:
                    Align: =Align.Center
                    Height: =DataCardKey39.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey39.Y
                    ZIndex: =4

            CommercialComments_DataCard1 As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="CommercialComments"
                Default: =ThisItem.CommercialComments
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@SMA_AT5],DataSourceInfo.DisplayName,"CommercialComments")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                MaxLength: =DataSourceInfo([@SMA_AT5], DataSourceInfo.MaxLength, "CommercialComments")
                Required: =false
                Update: =DataCardValue2.Text
                Visible: =false
                Width: =255
                X: =1
                Y: =1
                ZIndex: =1

                DataCardKey6 As label:
                    AutoHeight: =true
                    Height: =34
                    Text: ="Commercial Comments"
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue2 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey6.Y + DataCardKey6.Height + 5
                    ZIndex: =2

                ErrorMessage6 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue2.Y + DataCardValue2.Height
                    ZIndex: =3

                StarVisible6 As label:
                    Align: =Align.Center
                    Height: =DataCardKey6.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey6.Y
                    ZIndex: =4

            LastEditor_DataCard6 As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="LastEditor"
                Default: =currentUserEmail
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@SMA_AT5],DataSourceInfo.DisplayName,"LastEditor")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                MaxLength: =DataSourceInfo([@SMA_AT5], DataSourceInfo.MaxLength, "LastEditor")
                Required: =false
                Update: =DataCardValue53.Text
                Visible: =false
                Width: =255
                X: =2
                Y: =1
                ZIndex: =1

                DataCardKey67 As label:
                    AutoHeight: =true
                    Height: =34
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue53 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey67.Y + DataCardKey67.Height + 5
                    ZIndex: =2

                ErrorMessage52 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue53.Y + DataCardValue53.Height
                    ZIndex: =3

                StarVisible53 As label:
                    Align: =Align.Center
                    Height: =DataCardKey67.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey67.Y
                    ZIndex: =4

            Level_Calc_DataCard4 As typedDataCard.numberEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="Level_Calc"
                Default: =4
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@SMA_AT5],DataSourceInfo.DisplayName,"Level_Calc")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                Required: =true
                Update: =Value(DataCardValue54.Text)
                Visible: =false
                Width: =255
                X: =0
                Y: =2
                ZIndex: =1

                DataCardKey69 As label:
                    AutoHeight: =true
                    Height: =34
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue54 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Format: =TextFormat.Number
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey69.Y + DataCardKey69.Height + 5
                    ZIndex: =2

                ErrorMessage53 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue54.Y + DataCardValue54.Height
                    ZIndex: =3

                StarVisible54 As label:
                    Align: =Align.Center
                    Height: =DataCardKey69.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey69.Y
                    ZIndex: =4

        frmControl As form:
            AcceptsFocus: =false
            DataSource: =SMA_AT5
            Height: =106
            Item: =LookUp(SMA_AT5, ID2=SelectedPerson_ID)
            NumberOfColumns: =2
            Visible: =gblCrdControlSignoff
            Width: =747
            X: =46
            Y: =119
            ZIndex: =6

            PM_DIM_Approved_DataCard1_3 As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="ControlSignoff"
                Default: =ThisItem.ControlSignoff
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="ControlSignoff"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                MaxLength: =DataSourceInfo(SMA_AT5, DataSourceInfo.MaxLength, "ControlSignoff")
                Required: =false
                Update: =DataCardValue14_3.Text
                Width: =373
                X: =0
                Y: =0
                ZIndex: =1

                DataCardKey14_3 As label:
                    AutoHeight: =true
                    Color: =ApprovalKeyFontColor
                    Font: =Font.Arial
                    Height: =34
                    Text: ="Project Controls Signoff"
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue14_3 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    Default: =locApprovalText
                    DelayOutput: =true
                    DisplayMode: =DisplayMode.Disabled
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey14_3.Y + DataCardKey14_3.Height + 5
                    ZIndex: =2

            CommercialComments_DataCard2 As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="ControlComments"
                Default: =ThisItem.ControlComments
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@SMA_AT5],DataSourceInfo.DisplayName,"ControlComments")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                MaxLength: =DataSourceInfo([@SMA_AT5], DataSourceInfo.MaxLength, "ControlComments")
                Required: =false
                Update: =DataCardValue1.Text
                Width: =373
                X: =1
                Y: =0
                ZIndex: =1

                DataCardKey5 As label:
                    AutoHeight: =true
                    Height: =34
                    Text: ="Project Controls Comments"
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue1 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey5.Y + DataCardKey5.Height + 5
                    ZIndex: =2

                ErrorMessage5 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue1.Y + DataCardValue1.Height
                    ZIndex: =3

                StarVisible5 As label:
                    Align: =Align.Center
                    Height: =DataCardKey5.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey5.Y
                    ZIndex: =4

            Level_Calc_DataCard1 As typedDataCard.numberEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="Level_Calc"
                Default: =1
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@SMA_AT5],DataSourceInfo.DisplayName,"Level_Calc")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                Required: =true
                Update: =Value(DataCardValue13.Text)
                Visible: =false
                Width: =373
                X: =0
                Y: =1
                ZIndex: =1

                DataCardKey19 As label:
                    AutoHeight: =true
                    Height: =34
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue13 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Format: =TextFormat.Number
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey19.Y + DataCardKey19.Height + 5
                    ZIndex: =2

                ErrorMessage10 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue13.Y + DataCardValue13.Height
                    ZIndex: =3

                StarVisible18 As label:
                    Align: =Align.Center
                    Height: =DataCardKey19.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey19.Y
                    ZIndex: =4

            LastEditor_DataCard4 As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="LastEditor"
                Default: =
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@SMA_AT5],DataSourceInfo.DisplayName,"LastEditor")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                MaxLength: =DataSourceInfo([@SMA_AT5], DataSourceInfo.MaxLength, "LastEditor")
                Required: =false
                Update: =DataCardValue51.Text
                Visible: =false
                Width: =373
                X: =1
                Y: =1
                ZIndex: =1

                DataCardKey65 As label:
                    AutoHeight: =true
                    Height: =34
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue51 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    Default: =User().Email
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey65.Y + DataCardKey65.Height + 5
                    ZIndex: =2

                ErrorMessage50 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue51.Y + DataCardValue51.Height
                    ZIndex: =3

                StarVisible51 As label:
                    Align: =Align.Center
                    Height: =DataCardKey65.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey65.Y
                    ZIndex: =4

        frmPWAdded As form:
            AcceptsFocus: =false
            DataSource: =SMA_AT5
            Height: =106
            Item: =LookUp(SMA_AT5, ID2=SelectedPerson_ID)
            NumberOfColumns: =2
            Visible: =gblCrdPWAdded
            Width: =747
            X: =46
            Y: =119
            ZIndex: =7

            crd_PwAdded As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="PWAdded"
                Default: =locApprovalText
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Project Wise"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =56
                MaxLength: =DataSourceInfo(SMA_AT5, DataSourceInfo.MaxLength, "PWAdded")
                Required: =false
                Update: =DataCardValue14_4.Text
                Width: =373
                X: =0
                Y: =0
                ZIndex: =1

                DataCardKey14_4 As label:
                    AutoHeight: =true
                    Color: =ApprovalKeyFontColor
                    Font: =Font.Arial
                    Height: =34
                    Text: ="Project Wise Team"
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue14_4 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    Default: =locApprovalText
                    DelayOutput: =true
                    DisplayMode: =DisplayMode.Disabled
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey14_4.Y + DataCardKey14_4.Height + 5
                    ZIndex: =2

            Level_Calc_DataCard3 As typedDataCard.numberEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="Level_Calc"
                Default: =4
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="Level_Calc"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                Required: =true
                Update: =Value(DataCardValue3.Text)
                Visible: =false
                Width: =373
                X: =1
                Y: =0
                ZIndex: =1

                DataCardKey27 As label:
                    AutoHeight: =true
                    Height: =34
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue3 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Format: =TextFormat.Number
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey27.Y + DataCardKey27.Height + 5
                    ZIndex: =2

                ErrorMessage7 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue3.Y + DataCardValue3.Height
                    ZIndex: =3

                StarVisible7 As label:
                    Align: =Align.Center
                    Height: =DataCardKey27.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey27.Y
                    ZIndex: =4

            ID2_DataCard3 As typedDataCard.numberEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="ID2"
                Default: =ThisItem.ID2
                DisplayMode: =Parent.DisplayMode
                DisplayName: ="ID2"
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                Required: =true
                Update: =Value(DataCardValue28.Text)
                Visible: =false
                Width: =373
                X: =0
                Y: =1
                ZIndex: =1

                DataCardKey36 As label:
                    AutoHeight: =true
                    Height: =34
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue28 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Format: =TextFormat.Number
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey36.Y + DataCardKey36.Height + 5
                    ZIndex: =2

                ErrorMessage14 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue28.Y + DataCardValue28.Height
                    ZIndex: =3

                StarVisible14 As label:
                    Align: =Align.Center
                    Height: =DataCardKey36.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey36.Y
                    ZIndex: =4

            PWLevel_DataCard2 As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="PWLevel"
                Default: =ThisItem.PWLevel
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@SMA_AT5],DataSourceInfo.DisplayName,"PWLevel")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                MaxLength: =DataSourceInfo([@SMA_AT5], DataSourceInfo.MaxLength, "PWLevel")
                Required: =false
                Update: =DataCardValue5.Text
                Visible: =false
                Width: =373
                X: =1
                Y: =1
                ZIndex: =1

                DataCardKey7 As label:
                    AutoHeight: =true
                    Height: =34
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue5 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    Default: =drpPWlevel.SelectedText.Value
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey7.Y + DataCardKey7.Height + 5
                    ZIndex: =2

                ErrorMessage8 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue5.Y + DataCardValue5.Height
                    ZIndex: =3

                StarVisible8 As label:
                    Align: =Align.Center
                    Height: =DataCardKey7.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey7.Y
                    ZIndex: =4

            LastEditor_DataCard5 As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="LastEditor"
                Default: =currentUserEmail
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@SMA_AT5],DataSourceInfo.DisplayName,"LastEditor")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                MaxLength: =DataSourceInfo([@SMA_AT5], DataSourceInfo.MaxLength, "LastEditor")
                Required: =false
                Update: =DataCardValue52.Text
                Visible: =false
                Width: =373
                X: =0
                Y: =2
                ZIndex: =1

                DataCardKey66 As label:
                    AutoHeight: =true
                    Height: =34
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue52 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey66.Y + DataCardKey66.Height + 5
                    ZIndex: =2

                ErrorMessage51 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue52.Y + DataCardValue52.Height
                    ZIndex: =3

                StarVisible52 As label:
                    Align: =Align.Center
                    Height: =DataCardKey66.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey66.Y
                    ZIndex: =4

        drpPWlevel As dropdown:
            Items: =["Originator", "Approver", "Reviewer", "Checker", "Doc Control", "Supplier", "Production Hub"]
            Visible: =gblCrdPWAdded
            X: =465
            Y: =164
            ZIndex: =8

    pupReject As groupContainer.manualLayoutContainer:
        BorderColor: =ColorValue(ColorDarkBlue)
        BorderThickness: =1.5
        Fill: =RGBA(255, 255, 255, 1)
        Height: =344
        Visible: =Reject_UpVis
        Width: =839
        X: =284
        Y: =236
        ZIndex: =46

        lblApprovalPup1_3 As label:
            Align: =Align.Center
            Font: =Font.Arial
            Height: =42
            Text: |-
                ="I am rejecting " & SelectedPerson_Name & " request as: "
            Width: =838
            Y: =38
            ZIndex: =2

        btnRejectApproval_3 As button:
            BorderColor: =ColorValue(ColorRed)
            Color: =ColorValue(ColorRed)
            Fill: =ColorValue(ColorWhite)
            Font: =Font.Lato
            Height: =31
            HoverColor: =ColorValue(ColorWhite)
            HoverFill: =ColorValue(ColorRed)
            OnSelect: |-
                =Set(Reject_UpVis, false);
                Set(locGreyOutVis, false);
                Reset(txtRejectionNote);
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =12
            Text: ="Cancel"
            Width: =144
            X: =145
            Y: =263
            ZIndex: =3

        btnApplyEdit_6 As button:
            BorderThickness: =1
            DisplayMode: |-
                =If(!IsBlank(txtRejectionNote),
                    DisplayMode.Edit,
                    DisplayMode.Disabled)
            Fill: =ColorValue(ColorLightBlue)
            Font: =Font.Arial
            Height: =31
            HoverFill: =ColorValue(ColorGray)
            OnSelect: |-
                =// show processing label
                Set(locLblProcessingVis, true);
                
                Patch(
                    SMA_AT5,
                    {ID2: SelectedPerson_ID},
                    {Rej_calc: 1},
                    {Rejected: txtRejectionNote.Text},
                    {ControlSignoff: locApprovalText},
                    {LastEditor: User().Email}
                );
                
                Set(Reject_UpVis, false);
                Set(locLblProcessingVis, false);
                Set(SelectedPerson_Name, "");
                Set(locGreyOutVis, false);
                
                // Send email 
                flwRejectPCEmail_01.Run(locRequestorEmail, locRequestorProject, User().Email, txtRejectionNote.Text);
                
                //Create Main Collection - Part 1/2 - For the specified Level_Calc and HomeOrganisation filters
                Switch(
                    gblUserGroupId_A,
                    //PM Workstream lead
                    1, If(
                        First(gblUserHomeOrg.Result).Result = "All",
                        ClearCollect(colNewStartersPM_HomeOrg, Filter(SMA_AT5, Level_Calc=2)),
                        ClearCollect(colNewStartersPM_HomeOrg, Filter(SMA_AT5, Level_Calc=2, HomeOrganisation=First(gblUserHomeOrg.Result).Result))
                    ),
                    //Director Manager
                    2, If(
                        First(gblUserHomeOrg.Result).Result = "All",
                        ClearCollect(colNewStartersDM_HomeOrg, Filter(SMA_AT5, Level_Calc=3)),
                        ClearCollect(colNewStartersDM_HomeOrg, Filter(SMA_AT5, Level_Calc=3, HomeOrganisation=First(gblUserHomeOrg.Result).Result))
                    ),
                    //National Highways
                    3, ClearCollect(colNewStartersNH, Filter(SMA_AT5, Level_Calc=1)),
                
                    //Project Controls
                    7, If(
                        First(gblUserHomeOrg.Result).Result = "All",
                        ClearCollect(colPeopleForApproval_HomeOrg, Filter(SMA_AT5, ControlSignoff = Blank() Or ControlSignoff = "" Or ControlSignoff = "No", Level_Calc=0)),
                        ClearCollect(colPeopleForApproval_HomeOrg, Filter(SMA_AT5, ControlSignoff = Blank() Or ControlSignoff = "" Or ControlSignoff = "No", Level_Calc=0, HomeOrganisation=First(gblUserHomeOrg.Result).Result))
                    ),
                    //Project Accountant
                    8, If(
                        First(gblUserHomeOrg.Result).Result = "All",
                        ClearCollect(colPeopleForApproval_HomeOrg, Filter(SMA_AT5, AccountantSignoff = Blank() Or AccountantSignoff = "" Or AccountantSignoff = "No", Level_Calc=4)),
                        ClearCollect(colPeopleForApproval_HomeOrg, Filter(SMA_AT5, AccountantSignoff = Blank() Or AccountantSignoff = "" Or AccountantSignoff = "No", Level_Calc=4, HomeOrganisation=First(gblUserHomeOrg.Result).Result))
                    ),
                    //Project Wise
                    9, If(
                        First(gblUserHomeOrg.Result).Result = "All",
                        ClearCollect(colPeopleForApproval_HomeOrg, Filter(SMA_AT5, PWAdded = Blank() Or PWAdded = "" Or PWAdded = "No", Level_Calc=4)),
                        ClearCollect(colPeopleForApproval_HomeOrg, Filter(SMA_AT5, PWAdded = Blank() Or PWAdded = "" Or PWAdded = "No", Level_Calc=4, HomeOrganisation=First(gblUserHomeOrg.Result).Result))
                    )
                );
                //Create Main Collection - Part 2/2 - For the specified Level_Calc and Project filters
                Switch(
                    gblUserGroupId_A,
                    //PM Workstream lead
                    1, If(
                        "All" in gblUserProjects,
                        ClearCollect(colNewStartersPM, Filter(colNewStartersPM_HomeOrg, Level_Calc=2)),
                        "Production Hub" in gblUserProjects,
                        ClearCollect(colNewStartersPM, Filter(colNewStartersPM_HomeOrg, Level_Calc=2, Project in gblUserProjects, Discipline in gblUserDis)),
                        ClearCollect(colNewStartersPM, Filter(colNewStartersPM_HomeOrg, Level_Calc=2, Project in gblUserProjects))
                    ),
                    //Director Manager
                    2, If(
                        "All" in gblUserProjects,
                        ClearCollect(colNewStartersDM, Filter(colNewStartersDM_HomeOrg, Level_Calc=3)),
                        "Production Hub" in gblUserProjects,
                        ClearCollect(colNewStartersDM, Filter(colNewStartersDM_HomeOrg, Level_Calc=3, Project in gblUserProjects, Discipline in gblUserDis)),
                        ClearCollect(colNewStartersDM, Filter(colNewStartersDM_HomeOrg, Level_Calc=3, Project in gblUserProjects))
                    ),
                    //National Highways
                    3,  ClearCollect(colNewStartersNH, Filter(SMA_AT5, Level_Calc=1)),
                    
                    //Project Controls
                    7, If(
                        "All" in gblUserProjects,
                        ClearCollect(colPeopleForApproval, Filter(colPeopleForApproval_HomeOrg, ControlSignoff = Blank() Or ControlSignoff = "" Or ControlSignoff = "No", Level_Calc=0)),
                        "Production Hub" in gblUserProjects,
                        ClearCollect(colPeopleForApproval, Filter(colPeopleForApproval_HomeOrg, ControlSignoff = Blank() Or ControlSignoff = "" Or ControlSignoff = "No", Level_Calc=0, Project in gblUserProjects, Discipline in gblUserDis)),
                        ClearCollect(colPeopleForApproval, Filter(colPeopleForApproval_HomeOrg, ControlSignoff = Blank() Or ControlSignoff = "" Or ControlSignoff = "No", Level_Calc=0, Project in gblUserProjects))
                    ),
                    //Project Accountant
                    8, If(
                        "All" in gblUserProjects,
                        ClearCollect(colPeopleForApproval, Filter(colPeopleForApproval_HomeOrg, AccountantSignoff = Blank() Or AccountantSignoff = "" Or AccountantSignoff = "No", Level_Calc=4)),
                        "Production Hub" in gblUserProjects,
                        ClearCollect(colPeopleForApproval, Filter(colPeopleForApproval_HomeOrg, AccountantSignoff = Blank() Or AccountantSignoff = "" Or AccountantSignoff = "No", Level_Calc=4, Project in gblUserProjects, Discipline in gblUserDis)),
                        ClearCollect(colPeopleForApproval, Filter(colPeopleForApproval_HomeOrg, AccountantSignoff = Blank() Or AccountantSignoff = "" Or AccountantSignoff = "No", Level_Calc=4, Project in gblUserProjects))
                    ),
                    //Project Wise
                    9, If(
                        "All" in gblUserProjects,
                        ClearCollect(colPeopleForApproval, Filter(colPeopleForApproval_HomeOrg, PWAdded = Blank() Or PWAdded = "" Or PWAdded = "No", Level_Calc=4)),
                        "Production Hub" in gblUserProjects,
                        ClearCollect(colPeopleForApproval, Filter(colPeopleForApproval_HomeOrg, PWAdded = Blank() Or PWAdded = "" Or PWAdded = "No", Level_Calc=4, Project in gblUserProjects, Discipline in gblUserDis)),
                        ClearCollect(colPeopleForApproval, Filter(colPeopleForApproval_HomeOrg, PWAdded = Blank() Or PWAdded = "" Or PWAdded = "No", Level_Calc=4, Project in gblUserProjects))
                    ));
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =12
            Text: ="Apply changes"
            X: =534
            Y: =263
            ZIndex: =4

        lblApprovalPup1_4 As label:
            Align: =Align.Center
            Font: =Font.Arial
            FontWeight: =FontWeight.Semibold
            Height: =42
            Text: =User().Email
            Width: =838
            Y: =80
            ZIndex: =5

        txtRejectionNote As text:
            BorderColor: =RGBA(179, 179, 179, 1)
            Default: =
            Height: =44
            HoverBorderColor: =ColorValue(ColorLightBlue)
            HoverFill: =RGBA(0, 0, 0, 0)
            MaxLength: =250
            PressedBorderColor: =ColorValue(ColorLightBlue)
            Width: =572
            X: =145
            Y: =172
            ZIndex: =6

        lblApprovalPup1_5 As label:
            Align: =Align.Center
            Font: =Font.Arial
            Height: =42
            Text: |-
                ="Reason of rejection:"
            Width: =838
            Y: =126
            ZIndex: =7

    grpMassApproval As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =48

        toggleMassiveApproval As toggleSwitch:
            Color: =Color.White
            Height: =21
            OnChange: =
            OnCheck: |-
                =UpdateContext({locMassiveApproval: true})
            OnSelect: =ClearCollect(colMassiveApproval, Blank())
            OnUncheck: |-
                =UpdateContext({locMassiveApproval: false})
            Size: =11
            TrueFill: =ColorValue(ColorDarkBlue)
            Width: =84
            X: =26
            Y: =91
            ZIndex: =38

        lblMassive As label:
            Color: =ColorValue(ColorWhite)
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            Height: =31
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =10
            Text: ="Mass Approval"
            Underline: =true
            Width: =130
            X: =26
            Y: =57
            ZIndex: =40

        "galMassiveApproval As gallery.'BrowseLayout_Vertical_ThreeTextVariant_ver4.0'":
            BorderColor: =ColorValue(ColorLightBlue)
            Fill: =RGBA(255, 255, 255, 1)
            Height: =405
            Items: =SortByColumns(colMassiveApproval, "Title")
            Layout: =Layout.Vertical
            OnSelect: =
            TemplatePadding: =0
            TemplateSize: =70
            Visible: =locMassiveApproval
            Width: =360
            X: =1006
            Y: =285
            ZIndex: =41

            Title2_4 As label:
                Color: =ColorValue(ColorDarkBlue)
                Height: =Self.Size * 1.8
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =12
                Text: =ThisItem.Title
                VerticalAlign: =VerticalAlign.Top
                Width: =Parent.TemplateWidth - 104
                X: =60
                Y: =16
                ZIndex: =1

            galMAssiveApproval As label:
                Color: =ColorValue(ColorBlack)
                Height: =Self.Size * 4
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =10
                Text: |-
                    ="Project: " & ThisItem.Project
                VerticalAlign: =VerticalAlign.Top
                Width: =Parent.TemplateWidth - 104
                X: =60
                Y: =37
                ZIndex: =3

            NextArrow2_3 As icon.ChevronRight:
                AccessibleLabel: =Self.Tooltip
                Color: =ColorValue(ColorLightBlue)
                Height: =60
                HoverColor: =ColorValue(ColorGray)
                Icon: =Icon.ChevronLeft
                OnSelect: |-
                    =// Set variable for gallery look up
                    Set(SelectedPerson_ID, ThisItem.ID2);
                    Set(SelectedPerson_Name, ThisItem.Title)
                PaddingBottom: =10
                PaddingLeft: =10
                PaddingRight: =10
                PaddingTop: =10
                TabIndex: =0
                Tooltip: ="View item details"
                Width: =60
                Y: =6
                ZIndex: =4

            Separator2_4 As rectangle:
                BorderColor: =RGBA(237, 237, 237, 1)
                BorderThickness: =0.5
                Fill: =RGBA(0, 0, 0, 0)
                Height: =1
                OnSelect: =Select(Parent)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - 1
                ZIndex: =5

            NextArrow2_4 As icon.ChevronRight:
                AccessibleLabel: =Self.Tooltip
                Color: |
                    =Color.Red
                Height: =43
                HoverColor: =ColorValue(ColorGray)
                Icon: =Icon.Cancel
                OnSelect: =Remove(colMassiveApproval, ThisItem)
                PaddingBottom: =10
                PaddingLeft: =10
                PaddingRight: =10
                PaddingTop: =10
                TabIndex: =0
                Tooltip: ="View item details"
                Width: =43
                X: =358
                Y: =14
                ZIndex: =6

        lblMassiveApproval As label:
            Align: =Align.Center
            Color: =ColorValue(ColorWhite)
            Fill: =ColorValue(ColorLightBlue)
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            Height: =51
            Text: ="Selected to mass approval"
            Visible: =locMassiveApproval
            Width: =362
            X: =1004
            Y: =232
            ZIndex: =42

        lblMassiveGalleryNoItem As label:
            Height: =96
            Text: ="No item to display. Select one of the users from the gallery"
            Visible: =If(locMassiveApproval And CountRows(colMassiveApproval)=0, true, false)
            Width: =259
            X: =1065
            Y: =400
            ZIndex: =43

        btnMassSelectAll As button:
            BorderColor: =ColorValue(ColorWhite)
            BorderThickness: =1
            Color: =ColorValue(ColorWhite)
            Fill: =RGBA(0, 0, 0, 0)
            Font: =Font.Lato
            FontWeight: =FontWeight.Lighter
            Height: =27
            HoverColor: =ColorValue(ColorGray)
            HoverFill: =
            OnSelect: =ClearCollect(colMassiveApproval, galPeopleFilters.AllItems)
            PaddingBottom: =1
            PaddingLeft: =1
            PaddingRight: =1
            PaddingTop: =1
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =10
            Text: ="Select All"
            Visible: =locMassiveApproval
            Width: =60
            X: =139
            Y: =90
            ZIndex: =50

    pupDate As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =53

        Rectangle3 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =164
            Visible: =pupDatePicker
            Width: =436
            X: =465
            Y: =265
            ZIndex: =47

        btnDateCancell As button:
            BorderColor: =ColorValue(ColorDarkBlue)
            BorderThickness: =0.5
            Color: =ColorValue(ColorWhite)
            DisplayMode: =If(!IsBlank(SelectedPerson_Name) Or SelectedPerson_Name <> "" Or CountRows(colMassiveApproval) > 0, DisplayMode.Edit, DisplayMode.Disabled)
            Fill: =ColorValue(ColorLightBlue)
            Font: =Font.Lato
            Height: =31
            HoverColor: =ColorValue(ColorWhite)
            HoverFill: =ColorValue(ColorGray)
            OnSelect: |-
                =Set(pupDatePicker, false);
                Set(locGreyOutVis,false);
                Set(locSetDate, "");
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =12
            Text: ="Cancel"
            Visible: =pupDatePicker
            Width: =144
            X: =703
            Y: =363
            ZIndex: =48

        btnApproveDate As button:
            BorderColor: =ColorValue(ColorDarkBlue)
            BorderThickness: =0.5
            Color: =ColorValue(ColorWhite)
            DisplayMode: =If(!IsBlank(SelectedPerson_Name) Or SelectedPerson_Name <> "" Or CountRows(colMassiveApproval) > 0, DisplayMode.Edit, DisplayMode.Disabled)
            Fill: =ColorValue(ColorLightBlue)
            Font: =Font.Lato
            Height: =31
            HoverColor: =ColorValue(ColorWhite)
            HoverFill: =ColorValue(ColorGray)
            OnSelect: |-
                =If( locSetDate = "START", Set(locSelectedPersonStartDate, Text(DatePicker1.SelectedDate,"yyyy-mm-dd")),
                    locSetDate = "END", Set(locSelectedPersonEndDate, Text(DatePicker1.SelectedDate,"yyyy-mm-dd")));
                Set(pupDatePicker, false);
                Set(locGreyOutVis,false);
                Set(locSetDate, "");
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =12
            Text: ="OK"
            Visible: =pupDatePicker
            Width: =144
            X: =519
            Y: =363
            ZIndex: =49

        DatePicker1 As datepicker:
            BorderColor: =ColorValue(ColorDarkBlue)
            IconBackground: =ColorValue(ColorDarkBlue)
            Visible: =pupDatePicker
            X: =519
            Y: =293
            ZIndex: =51

    grpHeaderMain As group:
        Height: =5
        Width: =5
        X: =40
        Y: =20
        ZIndex: =56

        shpHeaderBackground As rectangle:
            Fill: =ColorValue(ColorDarkBlue)
            Height: =50
            Width: =1366
            ZIndex: =16

        btnHome As button:
            Color: =ColorValue(ColorWhite)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            Fill: =RGBA(0, 0, 0, 0)
            HoverColor: =ColorValue(ColorGray)
            HoverFill: =
            OnSelect: |-
                =Navigate('01_Intro', ScreenTransition.Fade); Set(SelectedPerson_Name, "");
                Set(locApprovalText, ""); Set(locMassiveApproval, false); Reset(toggleMassiveApproval);
                Set(SelectedPerson_ID, Blank());
                Set(SelectedPerson_Name, Blank())
            PressedColor: =ColorValue(ColorLightBlue)
            PressedFill: =
            Size: =12
            Text: ="Home"
            Width: =86
            X: =139
            Y: =5
            ZIndex: =17

        lblSMP As label:
            BorderColor: =RGBA(0, 0, 0, 1)
            Color: =RGBA(255, 255, 255, 1)
            DisabledColor: =ColorFade(RGBA(47, 41, 43, 1), 70%)
            Font: =Font.Lato
            Height: =30
            HoverBorderColor: =lblSMP.BorderColor
            HoverColor: =lblSMP.Color
            HoverFill: =lblSMP.Fill
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            PressedBorderColor: =lblSMP.BorderColor
            PressedColor: =lblSMP.Color
            PressedFill: =lblSMP.Fill
            Size: =12
            Text: ="SMP "
            Visible: =If(!FormPattern.Details, true,false)
            Width: =36
            X: =18
            ZIndex: =18

        lblAccess As label:
            BorderColor: =RGBA(0, 0, 0, 1)
            Color: =RGBA(255, 255, 255, 1)
            DisabledColor: =ColorFade(RGBA(47, 41, 43, 1), 70%)
            Font: =Font.Lato
            Height: =26
            HoverBorderColor: =lblAccess.BorderColor
            HoverColor: =lblAccess.Color
            HoverFill: =lblAccess.Fill
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            PressedBorderColor: =lblAccess.BorderColor
            PressedColor: =lblAccess.Color
            PressedFill: =lblAccess.Fill
            Size: =8
            Text: ="SMP Alliance Portal"
            Visible: =If(!FormPattern.Details, true,false)
            Width: =112
            X: =23
            Y: =20
            ZIndex: =19

        lblAlliance As label:
            BorderColor: =RGBA(0, 0, 0, 1)
            Color: =RGBA(255, 255, 255, 1)
            DisabledColor: =ColorFade(RGBA(47, 41, 43, 1), 70%)
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            Height: =29
            HoverBorderColor: =lblAlliance.BorderColor
            HoverColor: =lblAlliance.Color
            HoverFill: =lblAlliance.Fill
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            PressedBorderColor: =lblAlliance.BorderColor
            PressedColor: =lblAlliance.Color
            PressedFill: =lblAlliance.Fill
            Size: =12
            Text: ="Alliance"
            Visible: =If(!FormPattern.Details, true,false)
            Width: =69
            X: =54
            ZIndex: =21

        btnHelp As button:
            Color: =ColorValue(ColorWhite)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            Fill: =RGBA(0, 0, 0, 0)
            HoverColor: =ColorValue(ColorGray)
            HoverFill: =
            OnSelect: =Navigate('05_Help', ScreenTransition.Fade); Set(SelectedPerson_Name, ""); Set(locMassiveApproval, false); Reset(toggleMassiveApproval)
            PressedColor: =ColorValue(ColorLightBlue)
            PressedFill: =
            Size: =12
            Text: ="Help"
            Width: =86
            X: =225
            Y: =5
            ZIndex: =22

        btnContact As button:
            Color: =ColorValue(ColorWhite)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            Fill: =RGBA(0, 0, 0, 0)
            HoverColor: =ColorValue(ColorGray)
            HoverFill: =
            OnSelect: =Navigate('06_Contact', ScreenTransition.Fade); Set(SelectedPerson_Name, ""); Set(locMassiveApproval, false); Reset(toggleMassiveApproval)
            PressedColor: =ColorValue(ColorLightBlue)
            PressedFill: =
            Size: =12
            Text: ="Contact"
            Width: =86
            X: =316
            Y: =5
            ZIndex: =23

        btnAdmin As button:
            Color: =ColorValue(ColorWhite)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            Fill: =RGBA(0, 0, 0, 0)
            HoverColor: =ColorValue(ColorGray)
            HoverFill: =
            OnSelect: |-
                =If(gblUserGroupId_A = 8, Navigate('07_Admin', ScreenTransition.Fade)); 
                Set(SelectedPerson_Name, ""); Set(locMassiveApproval, false); Reset(toggleMassiveApproval)
            PressedColor: =ColorValue(ColorLightBlue)
            PressedFill: =
            Size: =12
            Text: ="Admin"
            Width: =86
            X: =420
            Y: =5
            ZIndex: =24

        shpHeader As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =40
            Width: =1
            X: =130
            Y: =5
            ZIndex: =25

        txtUserEmail As label:
            Align: =Align.Right
            BorderColor: =RGBA(0, 0, 0, 1)
            Color: =ColorValue(ColorWhite)
            DisabledColor: =ColorFade(RGBA(47, 41, 43, 1), 70%)
            Font: =Font.Lato
            Height: =48
            HoverBorderColor: =txtUserEmail.BorderColor
            HoverColor: =txtUserEmail.Color
            HoverFill: =txtUserEmail.Fill
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            PressedBorderColor: =txtUserEmail.BorderColor
            PressedColor: =txtUserEmail.Color
            PressedFill: =txtUserEmail.Fill
            Size: =8
            Text: |-
                ="Logged as: " & currentUserEmail
            Visible: =If(!FormPattern.Details, true,false)
            Width: =337
            X: =951
            ZIndex: =28

        imgUser As image:
            Height: =37
            Image: =User().Image
            Width: =47
            X: =1302
            Y: =8
            ZIndex: =29

    pupProject As group:
        Height: =5
        Width: =5
        X: =-438
        Y: =-268
        ZIndex: =57

        Rectangle3_3 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =164
            Visible: =pupProjectPicker
            Width: =436
            X: =478
            Y: =334
            ZIndex: =53

        btnDateCancell_3 As button:
            BorderColor: =ColorValue(ColorDarkBlue)
            BorderThickness: =0.5
            Color: =ColorValue(ColorWhite)
            DisplayMode: =If(!IsBlank(SelectedPerson_Name) Or SelectedPerson_Name <> "" Or CountRows(colMassiveApproval) > 0, DisplayMode.Edit, DisplayMode.Disabled)
            Fill: =ColorValue(ColorLightBlue)
            Font: =Font.Lato
            Height: =31
            HoverColor: =ColorValue(ColorWhite)
            HoverFill: =ColorValue(ColorGray)
            OnSelect: |-
                =Set(pupProjectPicker, false);
                Set(locGreyOutVis,false);
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =12
            Text: ="Cancel"
            Visible: =pupProjectPicker
            Width: =144
            X: =716
            Y: =432
            ZIndex: =54

        btnApproveDate_3 As button:
            BorderColor: =ColorValue(ColorDarkBlue)
            BorderThickness: =0.5
            Color: =ColorValue(ColorWhite)
            DisplayMode: =If(!IsBlank(SelectedPerson_Name) Or SelectedPerson_Name <> "" Or CountRows(colMassiveApproval) > 0, DisplayMode.Edit, DisplayMode.Disabled)
            Fill: =ColorValue(ColorLightBlue)
            Font: =Font.Lato
            Height: =31
            HoverColor: =ColorValue(ColorWhite)
            HoverFill: =ColorValue(ColorGray)
            OnSelect: |-
                =Set(locGreyOutVis,false);
                Set(locSelectedPersonProject, ddProject.SelectedText.Value);
                Set(pupProjectPicker, false);
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =12
            Text: ="OK"
            Visible: =pupProjectPicker 
            Width: =144
            X: =532
            Y: =432
            ZIndex: =55

        ddProject As dropdown:
            Items: =ProjectList
            Visible: |-
                =//If(DetailsFormMode, FormMode.Edit)
                pupProjectPicker
            Width: =360
            X: =519
            Y: =366
            ZIndex: =59

    pupHomeOrg As group:
        Height: =5
        Width: =5
        X: =20
        Y: =20
        ZIndex: =61

        Rectangle3_6 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =164
            Visible: =pupHomeOrgPicker
            Width: =436
            X: =576
            Y: =352
            ZIndex: =52

        btnDateCancell_6 As button:
            BorderColor: =ColorValue(ColorDarkBlue)
            BorderThickness: =0.5
            Color: =ColorValue(ColorWhite)
            DisplayMode: =If(!IsBlank(SelectedPerson_Name) Or SelectedPerson_Name <> "" Or CountRows(colMassiveApproval) > 0, DisplayMode.Edit, DisplayMode.Disabled)
            Fill: =ColorValue(ColorLightBlue)
            Font: =Font.Lato
            Height: =31
            HoverColor: =ColorValue(ColorWhite)
            HoverFill: =ColorValue(ColorGray)
            OnSelect: |-
                =Set(pupHomeOrgPicker, false);
                Set(locGreyOutVis,false);
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =12
            Text: ="Cancel"
            Visible: =pupHomeOrgPicker
            Width: =144
            X: =814
            Y: =450
            ZIndex: =61

        btnApproveDate_6 As button:
            BorderColor: =ColorValue(ColorDarkBlue)
            BorderThickness: =0.5
            Color: =ColorValue(ColorWhite)
            DisplayMode: =If(!IsBlank(SelectedPerson_Name) Or SelectedPerson_Name <> "" Or CountRows(colMassiveApproval) > 0, DisplayMode.Edit, DisplayMode.Disabled)
            Fill: =ColorValue(ColorLightBlue)
            Font: =Font.Lato
            Height: =31
            HoverColor: =ColorValue(ColorWhite)
            HoverFill: =ColorValue(ColorGray)
            OnSelect: |-
                =Set(locGreyOutVis,false);
                Set(locSelectedPersonHomeOrg, ddProject_3.SelectedText.Value);
                Set(pupHomeOrgPicker, false);
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =12
            Text: ="OK"
            Visible: =pupHomeOrgPicker
            Width: =144
            X: =630
            Y: =450
            ZIndex: =62

        ddProject_3 As dropdown:
            Items: =HomeOrgList
            Visible: =pupHomeOrgPicker
            Width: =360
            X: =617
            Y: =384
            ZIndex: =70

    pupEndDate As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =67

        Rectangle3_9 As rectangle:
            BorderColor: =RGBA(255, 0, 0, 1)
            BorderThickness: =2
            Fill: =RGBA(255, 255, 255, 1)
            Height: =231
            Visible: =EndDateMandat
            Width: =436
            X: =485
            Y: =285
            ZIndex: =63

        btnDateCancell_9 As button:
            BorderColor: =ColorValue(ColorDarkBlue)
            BorderThickness: =0.5
            Color: =ColorValue(ColorWhite)
            DisplayMode: =If(!IsBlank(SelectedPerson_Name) Or SelectedPerson_Name <> "" Or CountRows(colMassiveApproval) > 0, DisplayMode.Edit, DisplayMode.Disabled)
            Fill: =ColorValue(ColorLightBlue)
            Font: =Font.Lato
            Height: =47
            HoverColor: =ColorValue(ColorWhite)
            HoverFill: =ColorValue(ColorGray)
            OnSelect: |-
                =Set(EndDateMandat, false);
                Set(locGreyOutVis, false)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =12
            Text: ="Cancel"
            Visible: =EndDateMandat
            Width: =300
            X: =558
            Y: =444
            ZIndex: =68

        Label12 As label:
            Color: =RGBA(255, 0, 0, 1)
            Height: =72
            Text: ="The End Date field should not be empty."
            Visible: =EndDateMandat
            Width: =338
            X: =539
            Y: =296
            ZIndex: =69

        Label12_2 As label:
            Color: =RGBA(255, 0, 0, 1)
            Height: =72
            Text: ="The End Date cannot be before the Start Date."
            Visible: =EndDateMandat
            Width: =386
            X: =513
            Y: =326
            ZIndex: =71

    lblLastEditorDetails As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =70

        Label17 As label:
            Height: =47
            Size: =8
            Text: |-
                ="Last editor: " & LookUp(SMA_AT5, ID2=SelectedPerson_ID).LastEditor
            Width: =360
            X: =1006
            Y: =94
            ZIndex: =56

        Label17_1 As label:
            Height: =43
            Size: =8
            Text: |-
                ="Last edit: " & LookUp(SMA_AT5, ID2=SelectedPerson_ID).SysStartTime
            Width: =301
            X: =1006
            Y: =133
            ZIndex: =57

        Label17_2 As label:
            Height: =44
            Size: =8
            Text: |-
                =If(
                        gblUserGroupId_A = 7,
                        "Home Organization Comment: " & LookUp(SMA_AT5, ID2=SelectedPerson_ID).ControlComments,
                        "Edit Comment: " & LookUp(SMA_AT5, ID2=SelectedPerson_ID).EditComment
                )
            Width: =359
            X: =1006
            Y: =151
            ZIndex: =58

        Label17_3 As label:
            Height: =43
            Size: =8
            Text: |-
                ="Editor organisation: " & LookUp(People, Email = (LookUp(SMA_AT5, ID2=SelectedPerson_ID).LastEditor)).Home_organisation
            Width: =301
            X: =1006
            Y: =115
            ZIndex: =60

    pupCsvExport As groupContainer.manualLayoutContainer:
        BorderColor: =ColorValue(ColorDarkBlue)
        BorderThickness: =1
        Fill: =ColorValue(ColorWhite)
        Height: =694
        Visible: =locPupCsvVisibility
        Width: =941
        X: =213
        Y: =37
        ZIndex: =72

        grpPupHeader As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =7

            shpPupHeader As rectangle:
                Fill: =ColorValue(ColorDarkBlue)
                Height: =42
                Width: =941
                ZIndex: =1

            lblSMP_1 As label:
                BorderColor: =RGBA(0, 0, 0, 1)
                Color: =RGBA(255, 255, 255, 1)
                DisabledColor: =ColorFade(RGBA(47, 41, 43, 1), 70%)
                Font: =Font.Lato
                Height: =27
                HoverBorderColor: =lblSMP_1.BorderColor
                HoverColor: =lblSMP_1.Color
                HoverFill: =lblSMP_1.Fill
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                PressedBorderColor: =lblSMP_1.BorderColor
                PressedColor: =lblSMP_1.Color
                PressedFill: =lblSMP_1.Fill
                Size: =12
                Text: ="SMP "
                Visible: =If(!FormPattern.Details, true,false)
                Width: =36
                X: =5
                ZIndex: =3

            lblAccess_1 As label:
                BorderColor: =RGBA(0, 0, 0, 1)
                Color: =RGBA(255, 255, 255, 1)
                DisabledColor: =ColorFade(RGBA(47, 41, 43, 1), 70%)
                Font: =Font.Lato
                Height: =24
                HoverBorderColor: =lblAccess_1.BorderColor
                HoverColor: =lblAccess_1.Color
                HoverFill: =lblAccess_1.Fill
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                PressedBorderColor: =lblAccess_1.BorderColor
                PressedColor: =lblAccess_1.Color
                PressedFill: =lblAccess_1.Fill
                Size: =8
                Text: ="SMP Alliance Portal"
                Visible: =If(!FormPattern.Details, true,false)
                Width: =112
                X: =10
                Y: =18
                ZIndex: =4

            lblAlliance_1 As label:
                BorderColor: =RGBA(0, 0, 0, 1)
                Color: =RGBA(255, 255, 255, 1)
                DisabledColor: =ColorFade(RGBA(47, 41, 43, 1), 70%)
                Font: =Font.Lato
                FontWeight: =FontWeight.Bold
                Height: =26
                HoverBorderColor: =lblAlliance_1.BorderColor
                HoverColor: =lblAlliance_1.Color
                HoverFill: =lblAlliance_1.Fill
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                PressedBorderColor: =lblAlliance_1.BorderColor
                PressedColor: =lblAlliance_1.Color
                PressedFill: =lblAlliance_1.Fill
                Size: =12
                Text: ="Alliance"
                Visible: =If(!FormPattern.Details, true,false)
                Width: =69
                X: =41
                ZIndex: =5

            shpHeader_1 As rectangle:
                Fill: =RGBA(255, 255, 255, 1)
                Height: |
                    =38
                Width: =1
                X: =110
                Y: =2
                ZIndex: =6

        cntRigtPanel As groupContainer.manualLayoutContainer:
            Height: =652
            Width: =310
            X: =631
            Y: =42
            ZIndex: =22

            btnClose As button:
                BorderColor: =ColorValue(ColorRed)
                Color: =ColorValue(ColorRed)
                Fill: =ColorValue(ColorWhite)
                Font: =Font.Lato
                Height: =31
                HoverColor: =ColorValue(ColorWhite)
                HoverFill: =ColorValue(ColorRed)
                OnSelect: |-
                    =Set(locPupCsvVisibility, false);
                    Set(locGreyOutVis, false);
                    UpdateContext({EmailSentInfo:false})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =12
                Text: ="Close"
                X: =75
                Y: =589
                ZIndex: =1

            btnCheckAll As button:
                BorderColor: =ColorValue(ColorLightBlue)
                Color: =ColorValue(ColorLightBlue)
                Fill: |
                    =ColorValue(ColorWhite)
                Font: =Font.Arial
                Height: =30
                OnSelect: =ClearCollect(colPeopleToExport, AddColumns(colAllPeople, "ChoosenToExport", true))
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Text: ="Select All"
                Width: =127
                X: =21
                Y: =12
                ZIndex: =2

            btnUnCheckAll As button:
                BorderColor: =ColorValue(ColorLightBlue)
                Color: =ColorValue(ColorLightBlue)
                Fill: |
                    =ColorValue(ColorWhite)
                Font: =Font.Arial
                Height: =30
                OnSelect: =ClearCollect(colPeopleToExport, AddColumns(colAllPeople, "ChoosenToExport", false))
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Text: ="Unselect All"
                Width: =127
                X: =160
                Y: =12
                ZIndex: =3

            btnExportAsJSON As export:
                Data: =Filter(colPeopleToExport, ChoosenToExport = true)
                Fill: =ColorValue(ColorDarkBlue)
                Font: =Font.Arial
                Height: =60
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Text: ="Export Data as JSON"
                Width: =200
                X: =55
                Y: =204
                ZIndex: =4

            btnExportCSV As button:
                Fill: =ColorValue(ColorDarkBlue)
                Font: =Font.Arial
                Height: =60
                OnSelect: |-
                    =//Below fields cannot be passed to flow as blank
                    UpdateIf(colPeopleToExport, IsBlank(Discipline), {Discipline: "None"});
                    UpdateIf(colPeopleToExport, IsBlank(HomeOrganisation), {HomeOrganisation: "None"});
                    UpdateIf(colPeopleToExport, IsBlank(Project), {Project: "None"});
                    
                    Set(locDataToExport, Text(JSON(Filter(colPeopleToExport, ChoosenToExport = true))));
                    flwCreateCsvAndSendv2.Run(locDataToExport, User().Email);
                    UpdateContext({EmailSentInfo: true})
                    //Set(locLinkToCSV, flwDownloadAsCsv.Run(locDataToExport).linkoutput)
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Text: ="Export Data as CSV"
                Width: =200
                X: =55
                Y: =315
                ZIndex: =5

            lblCSVLink As label:
                Color: =RGBA(99, 139, 44, 1)
                Font: =Font.Arial
                FontWeight: =FontWeight.Lighter
                Height: =110
                Text: |-
                    =//"Link to CSV table: https://smpalliancetest-my.sharepoint.com/:f:/r/personal/piotr_szubert_smpalliancetest_onmicrosoft_com/Documents" & locLinkToCSV
                    "The file has been sent to your email"
                VerticalAlign: =VerticalAlign.Top
                Visible: |-
                    =//If(locLinkToCSV = "empty", false, true)
                    EmailSentInfo
                Width: =249
                X: =33
                Y: =427
                ZIndex: =6

            lblLinktToCSV As text:
                Default: |-
                    ="Link to CSV table: https://smpalliancetest-my.sharepoint.com/:f:/r/personal/piotr_szubert_smpalliancetest_onmicrosoft_com/Documents" & locLinkToCSV
                DisplayMode: =DisplayMode.Disabled
                Height: =133
                Mode: =TextMode.MultiLine
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Visible: =If(locLinkToCSV = "empty", false, true)
                Width: =278
                X: =72
                Y: =427
                ZIndex: =7

        grpPupFilters As group:
            Height: =5
            Width: =5
            X: =40
            Y: =-50
            ZIndex: =22

            "galPeopleFilters_1 As gallery.'BrowseLayout_Vertical_ThreeTextVariant_ver4.0'":
                BorderColor: =ColorValue(ColorLightBlue)
                Height: =605
                Items: |+
                    =// Series of Ifs and filters to apply settings from filtters and search box
                    // Starting with if to val if search field is empty
                    
                        Filter(If(!IsBlank(txtNameSearch_1.Text),
                            Search(
                    
                            If(rdoGroup_1.Selected.Result = Blank() And rdoHomeOrganisation_1.Selected.Result = Blank() And rdoProject_1.Selected.Result = Blank(), 
                                colPeopleToExport, 
                            If(!IsBlank(rdoGroup_1.Selected.Result) And rdoHomeOrganisation_1.Selected.Result = Blank() And rdoProject_1.Selected.Result = Blank(), 
                                Filter(colPeopleToExport, Discipline = rdoGroup_1.Selected.Result),
                            If(rdoGroup_1.Selected.Result = Blank() And !IsBlank(rdoHomeOrganisation_1.Selected.Result) And rdoProject_1.Selected.Result = Blank(), 
                                Filter(colPeopleToExport, HomeOrganisation = rdoHomeOrganisation_1.Selected.Result),
                            If(rdoGroup_1.Selected.Result = Blank() And rdoHomeOrganisation_1.Selected.Result = Blank() And !IsBlank(rdoProject_1.Selected.Result), 
                                Filter(colPeopleToExport, Project = rdoProject_1.Selected.Result),
                            If(!IsBlank(rdoGroup_1.Selected.Result) And !IsBlank(rdoHomeOrganisation_1.Selected.Result) And rdoProject_1.Selected.Result = Blank(), 
                                Filter(colPeopleToExport, Discipline = rdoGroup_1.Selected.Result And HomeOrganisation = rdoHomeOrganisation_1.Selected.Result),
                            If(!IsBlank(rdoGroup_1.Selected.Result) And rdoHomeOrganisation_1.Selected.Result = Blank() And !IsBlank(rdoProject_1.Selected.Result), 
                                Filter(colPeopleToExport, Discipline = rdoGroup_1.Selected.Result And Project = rdoProject_1.Selected.Result),
                            If(rdoGroup_1.Selected.Result = Blank() And !IsBlank(rdoHomeOrganisation_1.Selected.Result) And !IsBlank(rdoProject_1.Selected.Result), 
                                Filter(colPeopleToExport, HomeOrganisation = rdoHomeOrganisation_1.Selected.Result And Project = rdoProject_1.Selected.Result),
                            If(!IsBlank(rdoGroup_1.Selected.Result) And !IsBlank(rdoHomeOrganisation_1.Selected.Result) And !IsBlank(rdoProject_1.Selected.Result), 
                                Filter(colPeopleToExport, 
                                Discipline = rdoGroup_1.Selected.Result And HomeOrganisation = rdoHomeOrganisation_1.Selected.Result And Project = rdoProject_1.Selected.Result))))))))),
                                
                            txtNameSearch_1.Text, "Email", "Discipline"),
                                
                            If(rdoGroup_1.Selected.Result = Blank() And rdoHomeOrganisation_1.Selected.Result = Blank() And rdoProject_1.Selected.Result = Blank(), 
                                colPeopleToExport, 
                            If(!IsBlank(rdoGroup_1.Selected.Result) And rdoHomeOrganisation_1.Selected.Result = Blank() And rdoProject_1.Selected.Result = Blank(), 
                                Filter(colPeopleToExport, Discipline = rdoGroup_1.Selected.Result),
                            If(rdoGroup_1.Selected.Result = Blank() And !IsBlank(rdoHomeOrganisation_1.Selected.Result) And rdoProject_1.Selected.Result = Blank(), 
                                Filter(colPeopleToExport, HomeOrganisation = rdoHomeOrganisation_1.Selected.Result),
                            If(rdoGroup_1.Selected.Result = Blank() And rdoHomeOrganisation_1.Selected.Result = Blank() And !IsBlank(rdoProject_1.Selected.Result), 
                                Filter(colPeopleToExport, Project = rdoProject_1.Selected.Result),
                            If(!IsBlank(rdoGroup_1.Selected.Result) And !IsBlank(rdoHomeOrganisation_1.Selected.Result) And rdoProject_1.Selected.Result = Blank(), 
                                Filter(colPeopleToExport, Discipline = rdoGroup_1.Selected.Result And HomeOrganisation = rdoHomeOrganisation_1.Selected.Result),
                            If(!IsBlank(rdoGroup_1.Selected.Result) And rdoHomeOrganisation_1.Selected.Result = Blank() And !IsBlank(rdoProject_1.Selected.Result), 
                                Filter(colPeopleToExport, Discipline = rdoGroup_1.Selected.Result And Project = rdoProject_1.Selected.Result),
                            If(rdoGroup_1.Selected.Result = Blank() And !IsBlank(rdoHomeOrganisation_1.Selected.Result) And !IsBlank(rdoProject_1.Selected.Result), 
                                Filter(colPeopleToExport, HomeOrganisation = rdoHomeOrganisation_1.Selected.Result And Project = rdoProject_1.Selected.Result),
                            If(!IsBlank(rdoGroup_1.Selected.Result) And !IsBlank(rdoHomeOrganisation_1.Selected.Result) And !IsBlank(rdoProject_1.Selected.Result), 
                                Filter(colPeopleToExport, 
                                Discipline = rdoGroup_1.Selected.Result And HomeOrganisation = rdoHomeOrganisation_1.Selected.Result And Project = rdoProject_1.Selected.Result)))))))))), !Rej_calc)
                    
                Layout: =Layout.Vertical
                OnSelect: =
                TemplatePadding: =0
                TemplateSize: =88
                Width: =398
                X: =233
                Y: =89
                ZIndex: =7

                Title2_3 As label:
                    Color: =ColorValue(ColorDarkBlue)
                    Height: =Self.Size * 1.8
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =12
                    Text: =ThisItem.Title
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 104
                    X: =32
                    Y: =16
                    ZIndex: =1

                Subtitle2_3 As label:
                    Color: =ColorValue(ColorBlack)
                    Height: =Self.Size * 1.8
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =10
                    Text: |-
                        ="Discipline: " & ThisItem.Discipline
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 104
                    X: =32
                    Y: =Title2_3.Y + Title2_3.Height + 2
                    ZIndex: =2

                Body2_3 As label:
                    Color: =ColorValue(ColorBlack)
                    Height: =30
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =10
                    Text: |-
                        ="Project: " & ThisItem.Project
                    VerticalAlign: =VerticalAlign.Top
                    Width: =315
                    X: =32
                    Y: =57
                    ZIndex: =3

                Separator2_3 As rectangle:
                    BorderColor: =RGBA(237, 237, 237, 1)
                    BorderThickness: =0.5
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =1
                    OnSelect: =Select(Parent)
                    Width: =Parent.TemplateWidth
                    Y: =Parent.TemplateHeight - 1
                    ZIndex: =5

                btnIsChoosenToExport As checkbox:
                    CheckboxBorderColor: =ColorValue(ColorGray)
                    CheckboxSize: =30
                    Default: =ThisItem.ChoosenToExport
                    Height: =41
                    OnSelect: |-
                        =Patch(colPeopleToExport, ThisItem, {ChoosenToExport:true})
                    OnUncheck: |-
                        =Patch(colPeopleToExport, ThisItem, {ChoosenToExport:false})
                    Text: =
                    Width: =34
                    X: =347
                    Y: =27
                    ZIndex: =6

            shpFiltersBackground_1 As rectangle:
                BorderColor: =RGBA(0, 0, 0, 0)
                Fill: =ColorValue(ColorLightBlue)
                Height: =652
                Width: =233
                Y: =42
                ZIndex: =8

            lblAllFilters_1 As label:
                Color: =ColorValue(ColorWhite)
                Font: =Font.Lato
                FontWeight: =FontWeight.Bold
                Height: =29
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =12
                Text: ="Filters"
                Width: =153
                X: =21
                Y: =47
                ZIndex: =9

            rdoProject_1 As radio:
                Color: =ColorValue(ColorWhite)
                Default: =Blank()
                Font: =Font.Lato
                Height: =94
                HoverColor: =ColorValue(ColorGray)
                Items: |-
                    =ForAll(Distinct(colPeopleForApproval, Project), {Result: ThisRecord.Value})
                PaddingBottom: =0
                PaddingTop: =0
                RadioBorderColor: =RGBA(116, 116, 116, 1)
                RadioSize: =18
                Size: =8
                Width: =217
                Y: =109
                ZIndex: =10

            rdoHomeOrganisation_1 As radio:
                Color: =ColorValue(ColorWhite)
                Default: =Blank()
                Font: =Font.Lato
                Height: =66
                HoverColor: =ColorValue(ColorGray)
                Items: |-
                    =ForAll(Distinct(colPeopleForApproval, HomeOrganisation), {Result: ThisRecord.Value})
                PaddingBottom: =0
                PaddingTop: =0
                RadioBorderColor: =RGBA(116, 116, 116, 1)
                RadioSize: =18
                Size: =8
                Width: =217
                X: =1
                Y: =249
                ZIndex: =11

            rdoGroup_1 As radio:
                Color: =ColorValue(ColorWhite)
                Default: =Blank()
                Font: =Font.Lato
                Height: =242
                HoverColor: =ColorValue(ColorGray)
                Items: |-
                    =ForAll(Distinct(colPeopleForApproval, Discipline), {Result: ThisRecord.Value})
                PaddingBottom: =0
                PaddingTop: =0
                RadioBorderColor: =RGBA(116, 116, 116, 1)
                RadioSize: =18
                Size: =8
                Width: =217
                Y: =368
                ZIndex: =12

            txtNameSearch_1 As text:
                BorderColor: =ColorValue(ColorLightBlue)
                BorderThickness: =1
                Default: =""
                Height: =47
                HintText: ="Search by requestor Name"
                HoverBorderColor: =ColorValue(ColorLightBlue)
                HoverFill: =ColorValue(ColorGray)
                Italic: =true
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =10
                Width: =344
                X: =233
                Y: =42
                ZIndex: =13

            btnClearprojects_1 As button:
                BorderColor: =ColorValue(ColorWhite)
                BorderThickness: =1
                Color: =ColorValue(ColorWhite)
                Fill: =RGBA(0, 0, 0, 0)
                Font: =Font.Lato
                FontWeight: =FontWeight.Lighter
                Height: =22
                HoverColor: =ColorValue(ColorGray)
                HoverFill: =
                OnSelect: |-
                    =// Reseting project radio on click
                    
                    Reset(rdoProject_1)
                PaddingBottom: =1
                PaddingLeft: =1
                PaddingRight: =1
                PaddingTop: =1
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =10
                Text: ="Clear"
                Width: =54
                X: =166
                Y: =76
                ZIndex: =14

            lblProjects_1 As label:
                Color: =ColorValue(ColorWhite)
                Font: =Font.Lato
                FontWeight: =FontWeight.Bold
                Height: =29
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =10
                Text: ="Projects"
                Underline: =true
                Width: =153
                X: =21
                Y: =71
                ZIndex: =15

            lblHome_1 As label:
                Color: =ColorValue(ColorWhite)
                Font: =Font.Lato
                FontWeight: =FontWeight.Bold
                Height: =29
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =10
                Text: ="Home Organisation"
                Underline: =true
                Width: =153
                X: =20
                Y: =214
                ZIndex: =16

            lblDiscipline_1 As label:
                Color: =ColorValue(ColorWhite)
                Font: =Font.Lato
                FontWeight: =FontWeight.Bold
                Height: =29
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =10
                Text: ="Discipline"
                Underline: =true
                Width: =153
                X: =20
                Y: =327
                ZIndex: =17

            btnClearTextSearch_1 As button:
                BorderColor: =Color.White
                BorderThickness: =0
                Color: =ColorValue(ColorWhite)
                Fill: =ColorValue(ColorGray)
                Font: =Font.Lato
                FontWeight: =FontWeight.Lighter
                Height: =47
                HoverColor: =ColorValue(ColorWhite)
                HoverFill: =ColorValue(ColorLightBlue)
                OnSelect: |-
                    =// Reseting HomeOrganization radio on click
                    
                    Reset(txtNameSearch_1)
                PaddingBottom: =1
                PaddingLeft: =1
                PaddingRight: =1
                PaddingTop: =1
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =10
                Text: ="Clear"
                Width: =54
                X: =577
                Y: =42
                ZIndex: =18

            btnClearHome_1 As button:
                BorderColor: =ColorValue(ColorWhite)
                BorderThickness: =1
                Color: =ColorValue(ColorWhite)
                Fill: =RGBA(0, 0, 0, 0)
                Font: =Font.Lato
                FontWeight: =FontWeight.Lighter
                Height: =22
                HoverColor: =ColorValue(ColorGray)
                HoverFill: =
                OnSelect: |-
                    =// Reseting project radio on click
                    
                    Reset(rdoHomeOrganisation_1)
                PaddingBottom: =1
                PaddingLeft: =1
                PaddingRight: =1
                PaddingTop: =1
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =10
                Text: ="Clear"
                Width: =54
                X: =162
                Y: =217
                ZIndex: =19

            btnClearDiscipline_1 As button:
                BorderColor: =ColorValue(ColorWhite)
                BorderThickness: =1
                Color: =ColorValue(ColorWhite)
                Fill: =RGBA(0, 0, 0, 0)
                Font: =Font.Lato
                FontWeight: =FontWeight.Lighter
                Height: =22
                HoverColor: =ColorValue(ColorGray)
                HoverFill: =
                OnSelect: |-
                    =// Reseting project radio on click
                    
                    Reset(rdoGroup_1)
                PaddingBottom: =1
                PaddingLeft: =1
                PaddingRight: =1
                PaddingTop: =1
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =10
                Text: ="Clear"
                Width: =54
                X: =165
                Y: =331
                ZIndex: =20

            btnClearAllfilters_1 As button:
                BorderColor: =ColorValue(ColorWhite)
                BorderThickness: =1
                Color: =ColorValue(ColorWhite)
                Fill: =RGBA(0, 0, 0, 0)
                Font: =Font.Lato
                FontWeight: =FontWeight.Lighter
                Height: =22
                HoverColor: =ColorValue(ColorGray)
                HoverFill: =
                OnSelect: |-
                    =// Reseting project radio on click
                    
                    Reset(rdoProject_1);
                    Reset(rdoHomeOrganisation_1);
                    Reset(rdoGroup_1)
                PaddingBottom: =1
                PaddingLeft: =1
                PaddingRight: =1
                PaddingTop: =1
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =10
                Text: ="Clear all filters"
                Width: =196
                X: =21
                Y: =634
                ZIndex: =21

    Label12_3 As label:
        Align: =Align.Center
        Color: =RGBA(255, 0, 0, 1)
        Height: =87
        Text: |-
            ="The Project field should not be 'Not applicable'
            "
        Visible: =EndDateMandat
        Width: =386
        X: =514
        Y: =349
        ZIndex: =73

    pupProductionHub As group:
        Height: =5
        Width: =5
        X: =20
        Y: =20
        ZIndex: =73

        Rectangle3_11 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =164
            Visible: |
                =pupProdHubPicker
            Width: =436
            X: =498
            Y: =354
            ZIndex: =64

        btnDateCancell_11 As button:
            BorderColor: =ColorValue(ColorDarkBlue)
            BorderThickness: =0.5
            Color: =ColorValue(ColorWhite)
            DisplayMode: =If(!IsBlank(SelectedPerson_Name) Or SelectedPerson_Name <> "" Or CountRows(colMassiveApproval) > 0, DisplayMode.Edit, DisplayMode.Disabled)
            Fill: =ColorValue(ColorLightBlue)
            Font: =Font.Lato
            Height: =31
            HoverColor: =ColorValue(ColorWhite)
            HoverFill: =ColorValue(ColorGray)
            OnSelect: |-
                =Set(pupProdHubPicker, false);
                Set(locGreyOutVis,false);
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =12
            Text: ="Cancel"
            Visible: |
                =pupProdHubPicker
            Width: =144
            X: =736
            Y: =452
            ZIndex: =65

        btnApproveDate_9 As button:
            BorderColor: =ColorValue(ColorDarkBlue)
            BorderThickness: =0.5
            Color: =ColorValue(ColorWhite)
            DisplayMode: =If(!IsBlank(SelectedPerson_Name) Or SelectedPerson_Name <> "" Or CountRows(colMassiveApproval) > 0, DisplayMode.Edit, DisplayMode.Disabled)
            Fill: =ColorValue(ColorLightBlue)
            Font: =Font.Lato
            Height: =31
            HoverColor: =ColorValue(ColorWhite)
            HoverFill: =ColorValue(ColorGray)
            OnSelect: |-
                =Set(locGreyOutVis,false);
                Set(locSelectedPersonProductionHub, ddProject_6.SelectedText.Value);
                Set(pupProdHubPicker, false);
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =12
            Text: ="OK"
            Visible: |
                =pupProdHubPicker
            Width: =144
            X: =552
            Y: =452
            ZIndex: =66

        ddProject_6 As dropdown:
            Items: =ProductionHubList
            Visible: |
                =pupProdHubPicker
            Width: =360
            X: =539
            Y: =386
            ZIndex: =67

    Label12_4 As label:
        Align: =Align.Center
        Color: =RGBA(255, 0, 0, 1)
        Height: =87
        Text: |-
            ="Please validate the Email.
            "
        Visible: =EndDateMandat
        Width: =386
        X: =509
        Y: =376
        ZIndex: =74

    pupSCCHeader As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =78

        Rectangle3_13 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =164
            Visible: =pupSCCHeaderPicker
            Width: =436
            X: =513
            Y: =372
            ZIndex: =75

        btnCancell_13 As button:
            BorderColor: =ColorValue(ColorDarkBlue)
            BorderThickness: =0.5
            Color: =ColorValue(ColorWhite)
            DisplayMode: =If(!IsBlank(SelectedPerson_Name) Or SelectedPerson_Name <> "" Or CountRows(colMassiveApproval) > 0, DisplayMode.Edit, DisplayMode.Disabled)
            Fill: =ColorValue(ColorLightBlue)
            Font: =Font.Lato
            Height: =31
            HoverColor: =ColorValue(ColorWhite)
            HoverFill: =ColorValue(ColorGray)
            OnSelect: |-
                =Set(pupSCCHeaderPicker, false);
                Set(locGreyOutVis,false);
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =12
            Text: ="Cancel"
            Visible: =pupSCCHeaderPicker
            Width: =144
            X: =756
            Y: =472
            ZIndex: =76

        btnApproveSCCHeader As button:
            BorderColor: =ColorValue(ColorDarkBlue)
            BorderThickness: =0.5
            Color: =ColorValue(ColorWhite)
            DisplayMode: =If(!IsBlank(SelectedPerson_Name) Or SelectedPerson_Name <> "" Or CountRows(colMassiveApproval) > 0, DisplayMode.Edit, DisplayMode.Disabled)
            Fill: =ColorValue(ColorLightBlue)
            Font: =Font.Lato
            Height: =31
            HoverColor: =ColorValue(ColorWhite)
            HoverFill: =ColorValue(ColorGray)
            OnSelect: |-
                =Set(locGreyOutVis,false);
                Set(locSelectedPersonSCCHeader, ddSCCHeader.SelectedText.Value);
                Set(pupSCCHeaderPicker, false);
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =12
            Text: ="OK"
            Visible: =pupSCCHeaderPicker
            Width: =144
            X: =572
            Y: =472
            ZIndex: =77

        ddSCCHeader As dropdown:
            Items: =SCCHeaderList
            Visible: =pupSCCHeaderPicker
            Width: =360
            X: =559
            Y: =406
            ZIndex: =79

